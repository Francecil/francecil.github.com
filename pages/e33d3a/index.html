<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Android模拟触控解决方案 | Gahing&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/img/logo.png">
    <meta name="description" content="前端技术博客。包括大前端、服务端、通用技术">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/img/logo.png">
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="keywords" content="前端博客">
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#d1fbf9e6">
    <meta name="baidu-site-verification" content="codeva-SokyIFDMe9">
    <meta name="google-site-verification" content="4k3G9ZEl7_r-tXh5BDu5MBGg5Yd5DUVfn-6hoynqvZ8">
    
    <link rel="preload" href="/assets/css/0.styles.e3fce75e.css" as="style"><link rel="preload" href="/assets/js/app.b016e1be.js" as="script"><link rel="preload" href="/assets/js/3.5735a215.js" as="script"><link rel="preload" href="/assets/js/341.c3172dd3.js" as="script"><link rel="prefetch" href="/assets/js/10.749ed46e.js"><link rel="prefetch" href="/assets/js/100.3d3ecd40.js"><link rel="prefetch" href="/assets/js/101.8b08d7c0.js"><link rel="prefetch" href="/assets/js/102.269b8968.js"><link rel="prefetch" href="/assets/js/103.18a8c0a1.js"><link rel="prefetch" href="/assets/js/104.c27acfed.js"><link rel="prefetch" href="/assets/js/105.59452215.js"><link rel="prefetch" href="/assets/js/106.fe117ea8.js"><link rel="prefetch" href="/assets/js/107.4f577930.js"><link rel="prefetch" href="/assets/js/108.eb477262.js"><link rel="prefetch" href="/assets/js/109.dd5294cc.js"><link rel="prefetch" href="/assets/js/11.21b53d1e.js"><link rel="prefetch" href="/assets/js/110.cb1f3ecc.js"><link rel="prefetch" href="/assets/js/111.bcc6a783.js"><link rel="prefetch" href="/assets/js/112.3aca799a.js"><link rel="prefetch" href="/assets/js/113.4c19cfd4.js"><link rel="prefetch" href="/assets/js/114.04995f93.js"><link rel="prefetch" href="/assets/js/115.63e6493c.js"><link rel="prefetch" href="/assets/js/116.ecff9349.js"><link rel="prefetch" href="/assets/js/117.105a1323.js"><link rel="prefetch" href="/assets/js/118.e495e43b.js"><link rel="prefetch" href="/assets/js/119.644e4225.js"><link rel="prefetch" href="/assets/js/12.99846875.js"><link rel="prefetch" href="/assets/js/120.acf889c1.js"><link rel="prefetch" href="/assets/js/121.e8b1e16a.js"><link rel="prefetch" href="/assets/js/122.93ef3e9e.js"><link rel="prefetch" href="/assets/js/123.d8e759dd.js"><link rel="prefetch" href="/assets/js/124.096f2329.js"><link rel="prefetch" href="/assets/js/125.1fd7f197.js"><link rel="prefetch" href="/assets/js/126.1e33363b.js"><link rel="prefetch" href="/assets/js/127.e2f0fc90.js"><link rel="prefetch" href="/assets/js/128.d07fa48f.js"><link rel="prefetch" href="/assets/js/129.5c476aee.js"><link rel="prefetch" href="/assets/js/13.1a14a710.js"><link rel="prefetch" href="/assets/js/130.fccde9f7.js"><link rel="prefetch" href="/assets/js/131.88dae8d0.js"><link rel="prefetch" href="/assets/js/132.ba21ce6b.js"><link rel="prefetch" href="/assets/js/133.0707d3b4.js"><link rel="prefetch" href="/assets/js/134.c08658cb.js"><link rel="prefetch" href="/assets/js/135.33dccf0f.js"><link rel="prefetch" href="/assets/js/136.8a9056c5.js"><link rel="prefetch" href="/assets/js/137.cd13e8a6.js"><link rel="prefetch" href="/assets/js/138.b07844e4.js"><link rel="prefetch" href="/assets/js/139.ba5e8f52.js"><link rel="prefetch" href="/assets/js/14.4862e46b.js"><link rel="prefetch" href="/assets/js/140.b6bdfd6f.js"><link rel="prefetch" href="/assets/js/141.78969332.js"><link rel="prefetch" href="/assets/js/142.33bd21e3.js"><link rel="prefetch" href="/assets/js/143.0ddca4e9.js"><link rel="prefetch" href="/assets/js/144.540c4a88.js"><link rel="prefetch" href="/assets/js/145.87f2553b.js"><link rel="prefetch" href="/assets/js/146.1743dadc.js"><link rel="prefetch" href="/assets/js/147.e2aa548e.js"><link rel="prefetch" href="/assets/js/148.f66a0be6.js"><link rel="prefetch" href="/assets/js/149.c7a1b5ac.js"><link rel="prefetch" href="/assets/js/15.100e3a61.js"><link rel="prefetch" href="/assets/js/150.2d271f48.js"><link rel="prefetch" href="/assets/js/151.d438548a.js"><link rel="prefetch" href="/assets/js/152.993b4046.js"><link rel="prefetch" href="/assets/js/153.31addc5c.js"><link rel="prefetch" href="/assets/js/154.a1bfdb6e.js"><link rel="prefetch" href="/assets/js/155.09a1f667.js"><link rel="prefetch" href="/assets/js/156.9bc8ffe2.js"><link rel="prefetch" href="/assets/js/157.f7edf793.js"><link rel="prefetch" href="/assets/js/158.9b7997e8.js"><link rel="prefetch" href="/assets/js/159.8005b0ea.js"><link rel="prefetch" href="/assets/js/16.1cd00db7.js"><link rel="prefetch" href="/assets/js/160.754f002b.js"><link rel="prefetch" href="/assets/js/161.50e69e61.js"><link rel="prefetch" href="/assets/js/162.9f78a918.js"><link rel="prefetch" href="/assets/js/163.5418923b.js"><link rel="prefetch" href="/assets/js/164.9075e68e.js"><link rel="prefetch" href="/assets/js/165.07f99a8e.js"><link rel="prefetch" href="/assets/js/166.266bbac5.js"><link rel="prefetch" href="/assets/js/167.e72154fb.js"><link rel="prefetch" href="/assets/js/168.f55041bd.js"><link rel="prefetch" href="/assets/js/169.5039830e.js"><link rel="prefetch" href="/assets/js/17.96d76682.js"><link rel="prefetch" href="/assets/js/170.f832aba9.js"><link rel="prefetch" href="/assets/js/171.3c388baa.js"><link rel="prefetch" href="/assets/js/172.5e691736.js"><link rel="prefetch" href="/assets/js/173.7a33a5c2.js"><link rel="prefetch" href="/assets/js/174.382eef16.js"><link rel="prefetch" href="/assets/js/175.34dc2aea.js"><link rel="prefetch" href="/assets/js/176.9b542bdb.js"><link rel="prefetch" href="/assets/js/177.4c70eda1.js"><link rel="prefetch" href="/assets/js/178.7e20c9a1.js"><link rel="prefetch" href="/assets/js/179.f2be941e.js"><link rel="prefetch" href="/assets/js/18.33ee84ff.js"><link rel="prefetch" href="/assets/js/180.e150dcb9.js"><link rel="prefetch" href="/assets/js/181.e6f6710c.js"><link rel="prefetch" href="/assets/js/182.53d5cea7.js"><link rel="prefetch" href="/assets/js/183.f8e652c9.js"><link rel="prefetch" href="/assets/js/184.d5697668.js"><link rel="prefetch" href="/assets/js/185.00103cfd.js"><link rel="prefetch" href="/assets/js/186.92922683.js"><link rel="prefetch" href="/assets/js/187.d329cb04.js"><link rel="prefetch" href="/assets/js/188.d44d129a.js"><link rel="prefetch" href="/assets/js/189.e8e61289.js"><link rel="prefetch" href="/assets/js/19.70172dda.js"><link rel="prefetch" href="/assets/js/190.12db5e15.js"><link rel="prefetch" href="/assets/js/191.3a5f87d3.js"><link rel="prefetch" href="/assets/js/192.0db9f0ee.js"><link rel="prefetch" href="/assets/js/193.a96a0055.js"><link rel="prefetch" href="/assets/js/194.c4f624b2.js"><link rel="prefetch" href="/assets/js/195.5c8da83a.js"><link rel="prefetch" href="/assets/js/196.3386c336.js"><link rel="prefetch" href="/assets/js/197.dacc47d3.js"><link rel="prefetch" href="/assets/js/198.3711385c.js"><link rel="prefetch" href="/assets/js/199.10fe71f7.js"><link rel="prefetch" href="/assets/js/20.c1a6197b.js"><link rel="prefetch" href="/assets/js/200.3f9f258a.js"><link rel="prefetch" href="/assets/js/201.900416ef.js"><link rel="prefetch" href="/assets/js/202.277eec4a.js"><link rel="prefetch" href="/assets/js/203.805f2aa4.js"><link rel="prefetch" href="/assets/js/204.a28096d1.js"><link rel="prefetch" href="/assets/js/205.523203e4.js"><link rel="prefetch" href="/assets/js/206.17ba21cf.js"><link rel="prefetch" href="/assets/js/207.0d4edb5c.js"><link rel="prefetch" href="/assets/js/208.b08551fe.js"><link rel="prefetch" href="/assets/js/209.3955b2b6.js"><link rel="prefetch" href="/assets/js/21.dcdcefee.js"><link rel="prefetch" href="/assets/js/210.fe55d21b.js"><link rel="prefetch" href="/assets/js/211.6a784df4.js"><link rel="prefetch" href="/assets/js/212.96e3cd1c.js"><link rel="prefetch" href="/assets/js/213.0aa4f3a9.js"><link rel="prefetch" href="/assets/js/214.d4aa2a60.js"><link rel="prefetch" href="/assets/js/215.4cd9324b.js"><link rel="prefetch" href="/assets/js/216.aa7db76c.js"><link rel="prefetch" href="/assets/js/217.c99e3732.js"><link rel="prefetch" href="/assets/js/218.39aef052.js"><link rel="prefetch" href="/assets/js/219.e0e97ff7.js"><link rel="prefetch" href="/assets/js/22.0819ca3c.js"><link rel="prefetch" href="/assets/js/220.f265c60d.js"><link rel="prefetch" href="/assets/js/221.e9a65d08.js"><link rel="prefetch" href="/assets/js/222.a712820d.js"><link rel="prefetch" href="/assets/js/223.4f0e26f1.js"><link rel="prefetch" href="/assets/js/224.a3eb67a2.js"><link rel="prefetch" href="/assets/js/225.c7c936f6.js"><link rel="prefetch" href="/assets/js/226.722c032d.js"><link rel="prefetch" href="/assets/js/227.6197e96a.js"><link rel="prefetch" href="/assets/js/228.5ad95106.js"><link rel="prefetch" href="/assets/js/229.49eca910.js"><link rel="prefetch" href="/assets/js/23.235ef4bd.js"><link rel="prefetch" href="/assets/js/230.d0e5af7f.js"><link rel="prefetch" href="/assets/js/231.4051fa41.js"><link rel="prefetch" href="/assets/js/232.6915adad.js"><link rel="prefetch" href="/assets/js/233.297ee020.js"><link rel="prefetch" href="/assets/js/234.6b36a4fb.js"><link rel="prefetch" href="/assets/js/235.1f81d144.js"><link rel="prefetch" href="/assets/js/236.9eec5bbf.js"><link rel="prefetch" href="/assets/js/237.659b9688.js"><link rel="prefetch" href="/assets/js/238.0b652907.js"><link rel="prefetch" href="/assets/js/239.0149bfb6.js"><link rel="prefetch" href="/assets/js/24.0b9efbb1.js"><link rel="prefetch" href="/assets/js/240.e61a8ec6.js"><link rel="prefetch" href="/assets/js/241.df420b8f.js"><link rel="prefetch" href="/assets/js/242.c6af7ed9.js"><link rel="prefetch" href="/assets/js/243.3132ec61.js"><link rel="prefetch" href="/assets/js/244.8bdb38d8.js"><link rel="prefetch" href="/assets/js/245.2a2861ca.js"><link rel="prefetch" href="/assets/js/246.b585ed43.js"><link rel="prefetch" href="/assets/js/247.edd53803.js"><link rel="prefetch" href="/assets/js/248.0c97f4fb.js"><link rel="prefetch" href="/assets/js/249.6c142ff1.js"><link rel="prefetch" href="/assets/js/25.40a7c252.js"><link rel="prefetch" href="/assets/js/250.2b17cde2.js"><link rel="prefetch" href="/assets/js/251.043e19fc.js"><link rel="prefetch" href="/assets/js/252.323180b1.js"><link rel="prefetch" href="/assets/js/253.19b96b8a.js"><link rel="prefetch" href="/assets/js/254.3101251b.js"><link rel="prefetch" href="/assets/js/255.430d169f.js"><link rel="prefetch" href="/assets/js/256.3e5cd65c.js"><link rel="prefetch" href="/assets/js/257.9f897ef3.js"><link rel="prefetch" href="/assets/js/258.8f4ec801.js"><link rel="prefetch" href="/assets/js/259.a1af252c.js"><link rel="prefetch" href="/assets/js/26.206b616d.js"><link rel="prefetch" href="/assets/js/260.53016b37.js"><link rel="prefetch" href="/assets/js/261.4ec6823a.js"><link rel="prefetch" href="/assets/js/262.173d5edc.js"><link rel="prefetch" href="/assets/js/263.6d1c2ea0.js"><link rel="prefetch" href="/assets/js/264.38b45d53.js"><link rel="prefetch" href="/assets/js/265.e118e210.js"><link rel="prefetch" href="/assets/js/266.0a2b0783.js"><link rel="prefetch" href="/assets/js/267.cdee3c50.js"><link rel="prefetch" href="/assets/js/268.fd5e6b8d.js"><link rel="prefetch" href="/assets/js/269.237a2742.js"><link rel="prefetch" href="/assets/js/27.3209cdcf.js"><link rel="prefetch" href="/assets/js/270.2760454f.js"><link rel="prefetch" href="/assets/js/271.ad32a8bb.js"><link rel="prefetch" href="/assets/js/272.8f1864db.js"><link rel="prefetch" href="/assets/js/273.646c2f87.js"><link rel="prefetch" href="/assets/js/274.fc539b7e.js"><link rel="prefetch" href="/assets/js/275.f4098527.js"><link rel="prefetch" href="/assets/js/276.efac6628.js"><link rel="prefetch" href="/assets/js/277.064b8b9a.js"><link rel="prefetch" href="/assets/js/278.76f1f9e8.js"><link rel="prefetch" href="/assets/js/279.deff13ee.js"><link rel="prefetch" href="/assets/js/28.900c3498.js"><link rel="prefetch" href="/assets/js/280.c0439bf0.js"><link rel="prefetch" href="/assets/js/281.63b2b522.js"><link rel="prefetch" href="/assets/js/282.82704c1e.js"><link rel="prefetch" href="/assets/js/283.94ec4ee2.js"><link rel="prefetch" href="/assets/js/284.fc9c79c2.js"><link rel="prefetch" href="/assets/js/285.9d2a3e7c.js"><link rel="prefetch" href="/assets/js/286.01a7cc61.js"><link rel="prefetch" href="/assets/js/287.25537891.js"><link rel="prefetch" href="/assets/js/288.cd2fe3a3.js"><link rel="prefetch" href="/assets/js/289.9df6e0bd.js"><link rel="prefetch" href="/assets/js/29.dc26a96d.js"><link rel="prefetch" href="/assets/js/290.5a38bb53.js"><link rel="prefetch" href="/assets/js/291.c525a6d5.js"><link rel="prefetch" href="/assets/js/292.fb7fb0b9.js"><link rel="prefetch" href="/assets/js/293.164e9be4.js"><link rel="prefetch" href="/assets/js/294.b621dffc.js"><link rel="prefetch" href="/assets/js/295.7b7ffbb1.js"><link rel="prefetch" href="/assets/js/296.d94a72a0.js"><link rel="prefetch" href="/assets/js/297.2943ddc0.js"><link rel="prefetch" href="/assets/js/298.a271d149.js"><link rel="prefetch" href="/assets/js/299.a500de6a.js"><link rel="prefetch" href="/assets/js/30.39b619c4.js"><link rel="prefetch" href="/assets/js/300.9233f6f9.js"><link rel="prefetch" href="/assets/js/301.6dadc73c.js"><link rel="prefetch" href="/assets/js/302.65c92a03.js"><link rel="prefetch" href="/assets/js/303.dbe8bd6b.js"><link rel="prefetch" href="/assets/js/304.c9598564.js"><link rel="prefetch" href="/assets/js/305.730b7625.js"><link rel="prefetch" href="/assets/js/306.4027cf73.js"><link rel="prefetch" href="/assets/js/307.aa78c536.js"><link rel="prefetch" href="/assets/js/308.ca523aca.js"><link rel="prefetch" href="/assets/js/309.7c45c858.js"><link rel="prefetch" href="/assets/js/31.dfad83db.js"><link rel="prefetch" href="/assets/js/310.b2ad52f3.js"><link rel="prefetch" href="/assets/js/311.be8d039a.js"><link rel="prefetch" href="/assets/js/312.7e4cca19.js"><link rel="prefetch" href="/assets/js/313.efb40a83.js"><link rel="prefetch" href="/assets/js/314.f9cbec71.js"><link rel="prefetch" href="/assets/js/315.e1bfb44a.js"><link rel="prefetch" href="/assets/js/316.4919a5c0.js"><link rel="prefetch" href="/assets/js/317.7faed087.js"><link rel="prefetch" href="/assets/js/318.5a04b742.js"><link rel="prefetch" href="/assets/js/319.fd066944.js"><link rel="prefetch" href="/assets/js/32.f05c35c9.js"><link rel="prefetch" href="/assets/js/320.415ad7c6.js"><link rel="prefetch" href="/assets/js/321.2e200f15.js"><link rel="prefetch" href="/assets/js/322.4269a199.js"><link rel="prefetch" href="/assets/js/323.8a32ed84.js"><link rel="prefetch" href="/assets/js/324.d43036d5.js"><link rel="prefetch" href="/assets/js/325.20e6db03.js"><link rel="prefetch" href="/assets/js/326.5984c534.js"><link rel="prefetch" href="/assets/js/327.1d76dcf5.js"><link rel="prefetch" href="/assets/js/328.0edce972.js"><link rel="prefetch" href="/assets/js/329.84bf0d22.js"><link rel="prefetch" href="/assets/js/33.80367dcf.js"><link rel="prefetch" href="/assets/js/330.0aed7f5f.js"><link rel="prefetch" href="/assets/js/331.dd6e7835.js"><link rel="prefetch" href="/assets/js/332.4e589384.js"><link rel="prefetch" href="/assets/js/333.96e62206.js"><link rel="prefetch" href="/assets/js/334.95ce04aa.js"><link rel="prefetch" href="/assets/js/335.be641811.js"><link rel="prefetch" href="/assets/js/336.15dd013f.js"><link rel="prefetch" href="/assets/js/337.17673fd8.js"><link rel="prefetch" href="/assets/js/338.08ea4f6a.js"><link rel="prefetch" href="/assets/js/339.2d997079.js"><link rel="prefetch" href="/assets/js/34.8c924d2b.js"><link rel="prefetch" href="/assets/js/340.75abc2fa.js"><link rel="prefetch" href="/assets/js/342.77a9b881.js"><link rel="prefetch" href="/assets/js/343.014d854b.js"><link rel="prefetch" href="/assets/js/344.1915cc6b.js"><link rel="prefetch" href="/assets/js/345.d35a8d00.js"><link rel="prefetch" href="/assets/js/346.ee326105.js"><link rel="prefetch" href="/assets/js/347.1f99a3c3.js"><link rel="prefetch" href="/assets/js/348.97050791.js"><link rel="prefetch" href="/assets/js/349.431ccd56.js"><link rel="prefetch" href="/assets/js/35.91857d8b.js"><link rel="prefetch" href="/assets/js/350.5d7eb542.js"><link rel="prefetch" href="/assets/js/351.451267a2.js"><link rel="prefetch" href="/assets/js/352.c5931690.js"><link rel="prefetch" href="/assets/js/353.d33d2cc9.js"><link rel="prefetch" href="/assets/js/354.d03189cd.js"><link rel="prefetch" href="/assets/js/355.60e303f9.js"><link rel="prefetch" href="/assets/js/356.3f6de452.js"><link rel="prefetch" href="/assets/js/357.baba20e2.js"><link rel="prefetch" href="/assets/js/358.ba45adbf.js"><link rel="prefetch" href="/assets/js/359.d41b1a9e.js"><link rel="prefetch" href="/assets/js/36.573949eb.js"><link rel="prefetch" href="/assets/js/360.00c69f22.js"><link rel="prefetch" href="/assets/js/361.d16984d0.js"><link rel="prefetch" href="/assets/js/362.6fba66f8.js"><link rel="prefetch" href="/assets/js/363.5cb78c9d.js"><link rel="prefetch" href="/assets/js/364.523f1b27.js"><link rel="prefetch" href="/assets/js/365.aab0ee1c.js"><link rel="prefetch" href="/assets/js/366.175ad430.js"><link rel="prefetch" href="/assets/js/367.3b26a67b.js"><link rel="prefetch" href="/assets/js/368.0de930c8.js"><link rel="prefetch" href="/assets/js/369.40b64dc8.js"><link rel="prefetch" href="/assets/js/37.8c2b658d.js"><link rel="prefetch" href="/assets/js/370.53d20da1.js"><link rel="prefetch" href="/assets/js/371.50cc93ec.js"><link rel="prefetch" href="/assets/js/372.9a065424.js"><link rel="prefetch" href="/assets/js/373.bdb02911.js"><link rel="prefetch" href="/assets/js/374.144e1591.js"><link rel="prefetch" href="/assets/js/375.190df16e.js"><link rel="prefetch" href="/assets/js/376.8ea6bc52.js"><link rel="prefetch" href="/assets/js/377.c6b50cf4.js"><link rel="prefetch" href="/assets/js/378.a187c7b9.js"><link rel="prefetch" href="/assets/js/379.c34998f1.js"><link rel="prefetch" href="/assets/js/38.4aba9ad7.js"><link rel="prefetch" href="/assets/js/380.a20d6720.js"><link rel="prefetch" href="/assets/js/381.7b1b725c.js"><link rel="prefetch" href="/assets/js/382.7b83406d.js"><link rel="prefetch" href="/assets/js/383.7d770c85.js"><link rel="prefetch" href="/assets/js/384.51d3b6e7.js"><link rel="prefetch" href="/assets/js/385.fa022945.js"><link rel="prefetch" href="/assets/js/386.3c8c75fb.js"><link rel="prefetch" href="/assets/js/387.4e47f3e9.js"><link rel="prefetch" href="/assets/js/388.9972ad98.js"><link rel="prefetch" href="/assets/js/389.7cf34f0b.js"><link rel="prefetch" href="/assets/js/39.bd76e2c0.js"><link rel="prefetch" href="/assets/js/390.865b83d5.js"><link rel="prefetch" href="/assets/js/391.37abefc8.js"><link rel="prefetch" href="/assets/js/392.4651be24.js"><link rel="prefetch" href="/assets/js/393.12ed92b1.js"><link rel="prefetch" href="/assets/js/394.f75d7184.js"><link rel="prefetch" href="/assets/js/395.9bfbba54.js"><link rel="prefetch" href="/assets/js/396.059dba3b.js"><link rel="prefetch" href="/assets/js/397.94f67b18.js"><link rel="prefetch" href="/assets/js/398.2b34bfe8.js"><link rel="prefetch" href="/assets/js/399.f6062946.js"><link rel="prefetch" href="/assets/js/4.e2e4efa4.js"><link rel="prefetch" href="/assets/js/40.fef722c8.js"><link rel="prefetch" href="/assets/js/400.c53b35a1.js"><link rel="prefetch" href="/assets/js/401.a40fcd4f.js"><link rel="prefetch" href="/assets/js/402.9e8b6d5b.js"><link rel="prefetch" href="/assets/js/403.2f78c27f.js"><link rel="prefetch" href="/assets/js/404.29b2e09f.js"><link rel="prefetch" href="/assets/js/405.7c25f55c.js"><link rel="prefetch" href="/assets/js/406.2728d463.js"><link rel="prefetch" href="/assets/js/407.c3544a2b.js"><link rel="prefetch" href="/assets/js/408.1ed434dd.js"><link rel="prefetch" href="/assets/js/409.9c4bde98.js"><link rel="prefetch" href="/assets/js/41.3016d55e.js"><link rel="prefetch" href="/assets/js/410.e7dba43e.js"><link rel="prefetch" href="/assets/js/411.0e91521c.js"><link rel="prefetch" href="/assets/js/412.bd57dfb0.js"><link rel="prefetch" href="/assets/js/413.de18a259.js"><link rel="prefetch" href="/assets/js/414.6cd515a9.js"><link rel="prefetch" href="/assets/js/415.9792f73e.js"><link rel="prefetch" href="/assets/js/416.221fdd54.js"><link rel="prefetch" href="/assets/js/417.6ed74201.js"><link rel="prefetch" href="/assets/js/418.65cd4c2e.js"><link rel="prefetch" href="/assets/js/419.6744b397.js"><link rel="prefetch" href="/assets/js/42.7255f8eb.js"><link rel="prefetch" href="/assets/js/420.fb662316.js"><link rel="prefetch" href="/assets/js/421.372f5b24.js"><link rel="prefetch" href="/assets/js/422.575790e5.js"><link rel="prefetch" href="/assets/js/423.c21164fb.js"><link rel="prefetch" href="/assets/js/424.b2d32f83.js"><link rel="prefetch" href="/assets/js/425.fb130fcd.js"><link rel="prefetch" href="/assets/js/426.f9b035c1.js"><link rel="prefetch" href="/assets/js/427.a2cc594f.js"><link rel="prefetch" href="/assets/js/428.bd8712b5.js"><link rel="prefetch" href="/assets/js/429.1459a0b7.js"><link rel="prefetch" href="/assets/js/43.98cb5218.js"><link rel="prefetch" href="/assets/js/430.3d189809.js"><link rel="prefetch" href="/assets/js/431.7b39b9da.js"><link rel="prefetch" href="/assets/js/432.6d74b24a.js"><link rel="prefetch" href="/assets/js/433.13b9b1bf.js"><link rel="prefetch" href="/assets/js/434.e1f21a79.js"><link rel="prefetch" href="/assets/js/435.49710558.js"><link rel="prefetch" href="/assets/js/436.60e6eebe.js"><link rel="prefetch" href="/assets/js/437.0b94fcfa.js"><link rel="prefetch" href="/assets/js/438.e8d6bc00.js"><link rel="prefetch" href="/assets/js/439.c6415179.js"><link rel="prefetch" href="/assets/js/44.4a98d105.js"><link rel="prefetch" href="/assets/js/440.2285da05.js"><link rel="prefetch" href="/assets/js/441.686a64d5.js"><link rel="prefetch" href="/assets/js/442.4530c9d5.js"><link rel="prefetch" href="/assets/js/443.8c86473b.js"><link rel="prefetch" href="/assets/js/444.e173a168.js"><link rel="prefetch" href="/assets/js/445.9101c362.js"><link rel="prefetch" href="/assets/js/446.b6effb4d.js"><link rel="prefetch" href="/assets/js/447.9bb097e6.js"><link rel="prefetch" href="/assets/js/448.4ca83776.js"><link rel="prefetch" href="/assets/js/449.4de51247.js"><link rel="prefetch" href="/assets/js/45.946fb95a.js"><link rel="prefetch" href="/assets/js/450.22c6af97.js"><link rel="prefetch" href="/assets/js/451.5817d7e5.js"><link rel="prefetch" href="/assets/js/452.d92d108f.js"><link rel="prefetch" href="/assets/js/453.218d914e.js"><link rel="prefetch" href="/assets/js/454.6ad6e8e2.js"><link rel="prefetch" href="/assets/js/455.039e5205.js"><link rel="prefetch" href="/assets/js/456.d385470e.js"><link rel="prefetch" href="/assets/js/457.102c9b27.js"><link rel="prefetch" href="/assets/js/458.d4788a0f.js"><link rel="prefetch" href="/assets/js/459.e7430a3a.js"><link rel="prefetch" href="/assets/js/46.030efdc5.js"><link rel="prefetch" href="/assets/js/460.7fb08fbd.js"><link rel="prefetch" href="/assets/js/461.305bbd0a.js"><link rel="prefetch" href="/assets/js/462.f16e0e20.js"><link rel="prefetch" href="/assets/js/463.15671ceb.js"><link rel="prefetch" href="/assets/js/464.e4d5ea43.js"><link rel="prefetch" href="/assets/js/465.9bbffefb.js"><link rel="prefetch" href="/assets/js/466.8c78f542.js"><link rel="prefetch" href="/assets/js/467.3c2e0e7d.js"><link rel="prefetch" href="/assets/js/468.7e006b70.js"><link rel="prefetch" href="/assets/js/469.7feab0ff.js"><link rel="prefetch" href="/assets/js/47.7c841741.js"><link rel="prefetch" href="/assets/js/470.6edff7d8.js"><link rel="prefetch" href="/assets/js/471.a6387f94.js"><link rel="prefetch" href="/assets/js/472.bea25156.js"><link rel="prefetch" href="/assets/js/473.3ae9c904.js"><link rel="prefetch" href="/assets/js/474.4ce67927.js"><link rel="prefetch" href="/assets/js/475.633c7f4a.js"><link rel="prefetch" href="/assets/js/476.4b1fd13a.js"><link rel="prefetch" href="/assets/js/477.5d99a626.js"><link rel="prefetch" href="/assets/js/478.d1b7cb0d.js"><link rel="prefetch" href="/assets/js/479.a56dad32.js"><link rel="prefetch" href="/assets/js/48.c7a920d7.js"><link rel="prefetch" href="/assets/js/480.b868e99f.js"><link rel="prefetch" href="/assets/js/481.08f3b75b.js"><link rel="prefetch" href="/assets/js/482.83305bd2.js"><link rel="prefetch" href="/assets/js/483.c3609665.js"><link rel="prefetch" href="/assets/js/484.faa8e907.js"><link rel="prefetch" href="/assets/js/485.5c83d61d.js"><link rel="prefetch" href="/assets/js/486.3701972c.js"><link rel="prefetch" href="/assets/js/487.00111ed9.js"><link rel="prefetch" href="/assets/js/488.ab5446ad.js"><link rel="prefetch" href="/assets/js/489.fe24845e.js"><link rel="prefetch" href="/assets/js/49.35d8db78.js"><link rel="prefetch" href="/assets/js/490.1b705115.js"><link rel="prefetch" href="/assets/js/491.1b3b7213.js"><link rel="prefetch" href="/assets/js/492.cebbeacf.js"><link rel="prefetch" href="/assets/js/5.f7874a9e.js"><link rel="prefetch" href="/assets/js/50.7ded8bc6.js"><link rel="prefetch" href="/assets/js/51.495892a1.js"><link rel="prefetch" href="/assets/js/52.d5ad5538.js"><link rel="prefetch" href="/assets/js/53.dcadd60a.js"><link rel="prefetch" href="/assets/js/54.5e1cbaae.js"><link rel="prefetch" href="/assets/js/55.2f3463e1.js"><link rel="prefetch" href="/assets/js/56.bca4304c.js"><link rel="prefetch" href="/assets/js/57.7554f14b.js"><link rel="prefetch" href="/assets/js/58.f00c9045.js"><link rel="prefetch" href="/assets/js/59.399c38e5.js"><link rel="prefetch" href="/assets/js/6.f614802e.js"><link rel="prefetch" href="/assets/js/60.e46bc9f6.js"><link rel="prefetch" href="/assets/js/61.46757ed9.js"><link rel="prefetch" href="/assets/js/62.b609266c.js"><link rel="prefetch" href="/assets/js/63.54ec5fb1.js"><link rel="prefetch" href="/assets/js/64.c7cf2a6f.js"><link rel="prefetch" href="/assets/js/65.24fc91d2.js"><link rel="prefetch" href="/assets/js/66.4ab33b2b.js"><link rel="prefetch" href="/assets/js/67.b43b8f50.js"><link rel="prefetch" href="/assets/js/68.4e2d09e7.js"><link rel="prefetch" href="/assets/js/69.3f3f8d4b.js"><link rel="prefetch" href="/assets/js/7.c92b4172.js"><link rel="prefetch" href="/assets/js/70.f65fb20b.js"><link rel="prefetch" href="/assets/js/71.fabe8d12.js"><link rel="prefetch" href="/assets/js/72.ea0e91be.js"><link rel="prefetch" href="/assets/js/73.fb01db0f.js"><link rel="prefetch" href="/assets/js/74.94a95913.js"><link rel="prefetch" href="/assets/js/75.405df525.js"><link rel="prefetch" href="/assets/js/76.a2907b96.js"><link rel="prefetch" href="/assets/js/77.4fc017c0.js"><link rel="prefetch" href="/assets/js/78.6657570e.js"><link rel="prefetch" href="/assets/js/79.5d12a696.js"><link rel="prefetch" href="/assets/js/8.9709f186.js"><link rel="prefetch" href="/assets/js/80.dfabbed4.js"><link rel="prefetch" href="/assets/js/81.8a8f9e10.js"><link rel="prefetch" href="/assets/js/82.910d5e9f.js"><link rel="prefetch" href="/assets/js/83.800a8528.js"><link rel="prefetch" href="/assets/js/84.0ae47a7e.js"><link rel="prefetch" href="/assets/js/85.4a965c9d.js"><link rel="prefetch" href="/assets/js/86.b50a0f4d.js"><link rel="prefetch" href="/assets/js/87.332fa564.js"><link rel="prefetch" href="/assets/js/88.b3541dd2.js"><link rel="prefetch" href="/assets/js/89.bd584c6c.js"><link rel="prefetch" href="/assets/js/9.c4a7c001.js"><link rel="prefetch" href="/assets/js/90.6bc710ca.js"><link rel="prefetch" href="/assets/js/91.d8959efa.js"><link rel="prefetch" href="/assets/js/92.b4271c59.js"><link rel="prefetch" href="/assets/js/93.a7ac12c0.js"><link rel="prefetch" href="/assets/js/94.218e86c6.js"><link rel="prefetch" href="/assets/js/95.c3f19389.js"><link rel="prefetch" href="/assets/js/96.586be53a.js"><link rel="prefetch" href="/assets/js/97.ec2bbda1.js"><link rel="prefetch" href="/assets/js/98.69990293.js"><link rel="prefetch" href="/assets/js/99.3d9bd18e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.00275b08.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e3fce75e.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Gahing's blog" class="logo"> <span class="site-name can-hide">Gahing's blog</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/knowledge/" class="nav-link">知识体系</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大前端" class="dropdown-title"><a href="/fe/" class="link-title">大前端</a> <span class="title" style="display:none;">大前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fe/basic/" class="nav-link">前端基础</a></li><li class="dropdown-item"><!----> <a href="/fe/frameworks/" class="nav-link">应用框架</a></li><li class="dropdown-item"><!----> <a href="/fe/engineering/" class="nav-link">工程能力</a></li><li class="dropdown-item"><!----> <a href="/fe/app-fundamentals/" class="nav-link">应用基础</a></li><li class="dropdown-item"><!----> <a href="/fe/specialties/" class="nav-link">专业领域</a></li><li class="dropdown-item"><!----> <a href="/fe/business/" class="nav-link">业务场景</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/network/" class="nav-link">网络基础</a></li><li class="dropdown-item"><!----> <a href="/algorithm/" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/data-structure/" class="nav-link">数据结构</a></li><li class="dropdown-item"><!----> <a href="/programming-paradigm/" class="nav-link">编程范式</a></li><li class="dropdown-item"><!----> <a href="/codec/" class="nav-link">编解码</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/aigc/" class="nav-link">AIGC</a></li><li class="dropdown-item"><h4>其他领域</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/app/" class="nav-link">客户端</a></li><li class="dropdown-subitem"><a href="/server/" class="nav-link">服务端</a></li><li class="dropdown-subitem"><a href="/design/" class="nav-link">产品设计</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/soft-quality/" class="nav-link">软素质</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生活 &amp; More" class="dropdown-title"><a href="/life/" class="link-title">生活 &amp; More</a> <span class="title" style="display:none;">生活 &amp; More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/interviews/" class="nav-link">面试经验</a></li><li class="dropdown-item"><!----> <a href="/life-summary/" class="nav-link">人生总结</a></li><li class="dropdown-item"><!----> <a href="/resume/" class="nav-link">个人简历</a></li><li class="dropdown-item"><!----> <a href="/cards/" class="nav-link">知识卡片</a></li><li class="dropdown-item"><!----> <a href="/pages/ideas/" class="nav-link">灵感记录</a></li><li class="dropdown-item"><!----> <a href="/practical-tips/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/knowledge-popularization/" class="nav-link">知识科普</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li><li class="dropdown-item"><!----> <a href="https://itoutiao.feishu.cn/base/COJCbzvJ5axnrTsOSIvcTYY7nmc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  美食推荐
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><h4>收藏夹</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://itoutiao.feishu.cn/docx/SAdidmcozohUmlxp29wcQtTXn2b" target="_blank" rel="noopener noreferrer" class="nav-link external">
  优质前端信息源
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/francecil/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.jpeg"> <div class="blogger-info"><h3>Gahing</h3> <span>To be best</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/knowledge/" class="nav-link">知识体系</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大前端" class="dropdown-title"><a href="/fe/" class="link-title">大前端</a> <span class="title" style="display:none;">大前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fe/basic/" class="nav-link">前端基础</a></li><li class="dropdown-item"><!----> <a href="/fe/frameworks/" class="nav-link">应用框架</a></li><li class="dropdown-item"><!----> <a href="/fe/engineering/" class="nav-link">工程能力</a></li><li class="dropdown-item"><!----> <a href="/fe/app-fundamentals/" class="nav-link">应用基础</a></li><li class="dropdown-item"><!----> <a href="/fe/specialties/" class="nav-link">专业领域</a></li><li class="dropdown-item"><!----> <a href="/fe/business/" class="nav-link">业务场景</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/network/" class="nav-link">网络基础</a></li><li class="dropdown-item"><!----> <a href="/algorithm/" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/data-structure/" class="nav-link">数据结构</a></li><li class="dropdown-item"><!----> <a href="/programming-paradigm/" class="nav-link">编程范式</a></li><li class="dropdown-item"><!----> <a href="/codec/" class="nav-link">编解码</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/aigc/" class="nav-link">AIGC</a></li><li class="dropdown-item"><h4>其他领域</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/app/" class="nav-link">客户端</a></li><li class="dropdown-subitem"><a href="/server/" class="nav-link">服务端</a></li><li class="dropdown-subitem"><a href="/design/" class="nav-link">产品设计</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/soft-quality/" class="nav-link">软素质</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生活 &amp; More" class="dropdown-title"><a href="/life/" class="link-title">生活 &amp; More</a> <span class="title" style="display:none;">生活 &amp; More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/interviews/" class="nav-link">面试经验</a></li><li class="dropdown-item"><!----> <a href="/life-summary/" class="nav-link">人生总结</a></li><li class="dropdown-item"><!----> <a href="/resume/" class="nav-link">个人简历</a></li><li class="dropdown-item"><!----> <a href="/cards/" class="nav-link">知识卡片</a></li><li class="dropdown-item"><!----> <a href="/pages/ideas/" class="nav-link">灵感记录</a></li><li class="dropdown-item"><!----> <a href="/practical-tips/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/knowledge-popularization/" class="nav-link">知识科普</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li><li class="dropdown-item"><!----> <a href="https://itoutiao.feishu.cn/base/COJCbzvJ5axnrTsOSIvcTYY7nmc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  美食推荐
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><h4>收藏夹</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://itoutiao.feishu.cn/docx/SAdidmcozohUmlxp29wcQtTXn2b" target="_blank" rel="noopener noreferrer" class="nav-link external">
  优质前端信息源
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/francecil/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Android</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>动态化技术</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>应用开发</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/b34eef/" class="sidebar-link">Android开发技巧</a></li><li><a href="/pages/e33d3a/" aria-current="page" class="active sidebar-link">Android模拟触控解决方案</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level1"><a href="/pages/e33d3a/#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header level1"><a href="/pages/e33d3a/#数据采集" class="sidebar-link">数据采集</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/e33d3a/#android端" class="sidebar-link">Android端</a></li><li class="sidebar-sub-header level2"><a href="/pages/e33d3a/#web" class="sidebar-link">Web</a></li><li class="sidebar-sub-header level2"><a href="/pages/e33d3a/#嵌入式设备" class="sidebar-link">嵌入式设备</a></li></ul></li><li class="sidebar-sub-header level1"><a href="/pages/e33d3a/#数据编码" class="sidebar-link">数据编码</a></li><li class="sidebar-sub-header level1"><a href="/pages/e33d3a/#数据传输" class="sidebar-link">数据传输</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/e33d3a/#socket" class="sidebar-link">socket</a></li><li class="sidebar-sub-header level3"><a href="/pages/e33d3a/#客户端" class="sidebar-link">客户端</a></li><li class="sidebar-sub-header level3"><a href="/pages/e33d3a/#服务端" class="sidebar-link">服务端</a></li><li class="sidebar-sub-header level2"><a href="/pages/e33d3a/#datachannel" class="sidebar-link">DataChannel</a></li></ul></li><li class="sidebar-sub-header level1"><a href="/pages/e33d3a/#数据解码" class="sidebar-link">数据解码</a></li><li class="sidebar-sub-header level1"><a href="/pages/e33d3a/#数据模拟" class="sidebar-link">数据模拟</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/e33d3a/#_1-adb-shell" class="sidebar-link">1. adb shell</a></li><li class="sidebar-sub-header level3"><a href="/pages/e33d3a/#_1-1-server端执行shell脚本" class="sidebar-link">1.1 server端执行shell脚本</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#大致流程" class="sidebar-link">大致流程：</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#实现难度-5-5" class="sidebar-link">实现难度：5/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#维护拓展-1-5" class="sidebar-link">维护拓展： 1/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#需要root-否" class="sidebar-link">需要root？ 否</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#效率延迟-1-5" class="sidebar-link">效率延迟：1/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#推荐指数-1-5" class="sidebar-link">推荐指数： 1/5</a></li><li class="sidebar-sub-header level3"><a href="/pages/e33d3a/#_1-2-android端执行adb-shell用户启动的程序" class="sidebar-link">1.2 android端执行adb shell用户启动的程序</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#大致流程-2" class="sidebar-link">大致流程：</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#实现难度-4-5" class="sidebar-link">实现难度：4/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#维护拓展-4-5" class="sidebar-link">维护拓展： 4/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#需要root-否-2" class="sidebar-link">需要root？ 否</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#效率延迟-5-5" class="sidebar-link">效率延迟：5/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#推荐指数-4-5-5" class="sidebar-link">推荐指数： 4.5/5</a></li><li class="sidebar-sub-header level2"><a href="/pages/e33d3a/#_2-android端-root-sendevent" class="sidebar-link">2. Android端 root sendevent</a></li><li class="sidebar-sub-header level3"><a href="/pages/e33d3a/#_2-1-runtime-getruntime-exec-su" class="sidebar-link">2.1 Runtime.getRuntime().exec(&quot;su&quot;)</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#大致流程-3" class="sidebar-link">大致流程：</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#实现难度-5-5-2" class="sidebar-link">实现难度：5/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#维护拓展-1-5-2" class="sidebar-link">维护拓展：1/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#需要root-是" class="sidebar-link">需要root？ 是</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#效率延迟-1-5-2" class="sidebar-link">效率延迟：1/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#推荐指数-1-5-2" class="sidebar-link">推荐指数： 1/5</a></li><li class="sidebar-sub-header level3"><a href="/pages/e33d3a/#_2-2-linux-c" class="sidebar-link">2.2 linux c</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#实现难度-4-5-5" class="sidebar-link">实现难度：4.5/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#维护拓展-3-5-5" class="sidebar-link">维护拓展：3.5/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#需要root-不确定" class="sidebar-link">需要root？ 不确定</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#效率延迟-5-5-2" class="sidebar-link">效率延迟：5/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#推荐指数-4-7-5" class="sidebar-link">推荐指数： 4.7/5</a></li><li class="sidebar-sub-header level3"><a href="/pages/e33d3a/#_2-3-jni" class="sidebar-link">2.3  jni</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#实现难度-5-5-3" class="sidebar-link">实现难度：5/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#维护拓展-4-5-2" class="sidebar-link">维护拓展：4/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#需要root-需要" class="sidebar-link">需要root？ 需要</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#效率延迟-5-5-3" class="sidebar-link">效率延迟：5/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#推荐指数-4-7-5-2" class="sidebar-link">推荐指数： 4.7/5</a></li><li class="sidebar-sub-header level3"><a href="/pages/e33d3a/#_2-4-roottools" class="sidebar-link">2.4  RootTools</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#实现难度-5-5-4" class="sidebar-link">实现难度：5/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#维护拓展-5-5" class="sidebar-link">维护拓展：5/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#需要root-是-2" class="sidebar-link">需要root？ 是</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#效率延迟-2-5" class="sidebar-link">效率延迟：2/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#推荐指数-2-5" class="sidebar-link">推荐指数： 2/5</a></li><li class="sidebar-sub-header level2"><a href="/pages/e33d3a/#_3-motionevent-obtain" class="sidebar-link">3. MotionEvent.obtain</a></li><li class="sidebar-sub-header level3"><a href="/pages/e33d3a/#_3-1-instrumentation" class="sidebar-link">3.1 Instrumentation</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#大致流程-4" class="sidebar-link">大致流程</a></li><li class="sidebar-sub-header level3"><a href="/pages/e33d3a/#_3-2-iwindowmanager" class="sidebar-link">3.2 IWindowManager</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#实现难度-4-5-2" class="sidebar-link">实现难度：4/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#维护拓展-4-5-3" class="sidebar-link">维护拓展：4/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#需要root-否-3" class="sidebar-link">需要root？ 否</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#效率延迟-3-5-5" class="sidebar-link">效率延迟：3.5/5</a></li><li class="sidebar-sub-header level4"><a href="/pages/e33d3a/#推荐指数-4-5" class="sidebar-link">推荐指数： 4/5</a></li><li class="sidebar-sub-header level2"><a href="/pages/e33d3a/#accessibilityservice" class="sidebar-link">Accessibilityservice</a></li></ul></li><li class="sidebar-sub-header level1"><a href="/pages/e33d3a/#附录" class="sidebar-link">附录</a></li><li class="sidebar-sub-header level1"><a href="/pages/e33d3a/#防退出全屏" class="sidebar-link">防退出全屏</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/e33d3a/#纯客户端去做" class="sidebar-link">纯客户端去做</a></li><li class="sidebar-sub-header level2"><a href="/pages/e33d3a/#做一个系统应用-需要有系统签名" class="sidebar-link">做一个系统应用，需要有系统签名</a></li></ul></li><li class="sidebar-sub-header level1"><a href="/pages/e33d3a/#捕获基本知识" class="sidebar-link">捕获基本知识</a></li><li class="sidebar-sub-header level1"><a href="/pages/e33d3a/#捕获时异常" class="sidebar-link">捕获时异常</a></li><li class="sidebar-sub-header level1"><a href="/pages/e33d3a/#模拟器不支持muiti-touch" class="sidebar-link">模拟器不支持Muiti-Touch</a></li></ul></li><li><a href="/pages/347b8f/" class="sidebar-link">Android监听屏幕旋转</a></li><li><a href="/pages/841da0/" class="sidebar-link">adb控制avd</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>系统原理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>语言基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>逆向技术</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>iOS</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-050bfbc2><div class="articleInfo" data-v-050bfbc2><ul class="breadcrumbs" data-v-050bfbc2><li data-v-050bfbc2><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-050bfbc2></a></li> <li data-v-050bfbc2><a href="/app/#客户端" data-v-050bfbc2>客户端</a></li><li data-v-050bfbc2><a href="/app/#Android" data-v-050bfbc2>Android</a></li><li data-v-050bfbc2><a href="/app/#应用开发" data-v-050bfbc2>应用开发</a></li></ul> <div class="info" data-v-050bfbc2><div title="作者" class="author iconfont icon-touxiang" data-v-050bfbc2><a href="https://github.com/francecil" target="_blank" title="作者" class="beLink" data-v-050bfbc2>gahing</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-050bfbc2><a href="javascript:;" data-v-050bfbc2>2016/11/18</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Android模拟触控解决方案<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h1> <p>如何捕获用户触控信息？如何模拟？</p> <h1 id="数据采集"><a href="#数据采集" class="header-anchor">#</a> 数据采集</h1> <h2 id="android端"><a href="#android端" class="header-anchor">#</a> Android端</h2> <p>重写 onTouchEvent ,收集 event 数据,以一定的编码传输</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onTouchEvent</span><span class="token punctuation">(</span><span class="token class-name">MotionEvent</span> event<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token class-name">String</span> rec<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> pointerCount <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getPointerCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pointerCount <span class="token operator">&gt;</span> <span class="token constant">MAX_TOUCHPOINTS</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        pointerCount <span class="token operator">=</span> <span class="token constant">MAX_TOUCHPOINTS</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> opt<span class="token operator">=</span>event<span class="token punctuation">.</span><span class="token function">getAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">boolean</span> isFirst<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>opt<span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pointerCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> id <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getPointerId</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> event<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> event<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>isFirst<span class="token punctuation">)</span><span class="token punctuation">{</span>isFirst<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
            <span class="token keyword">else</span> rec<span class="token operator">+=</span><span class="token string">&quot;;&quot;</span><span class="token punctuation">;</span>
            rec<span class="token operator">+=</span>id<span class="token operator">+</span><span class="token string">&quot;,2,&quot;</span><span class="token operator">+</span>x<span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span>y<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>opt<span class="token operator">==</span><span class="token number">0</span><span class="token operator">||</span><span class="token punctuation">(</span>opt<span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//为了简化，我们假设这过程不会进行MOVE</span>
        <span class="token keyword">int</span> ind<span class="token operator">=</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pointerCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span>ind<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">int</span> id <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getPointerId</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> event<span class="token punctuation">.</span><span class="token function">getX</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> event<span class="token punctuation">.</span><span class="token function">getY</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>isFirst<span class="token punctuation">)</span><span class="token punctuation">{</span>isFirst<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
                <span class="token keyword">else</span> rec<span class="token operator">+=</span><span class="token string">&quot;;&quot;</span><span class="token punctuation">;</span>
                rec<span class="token operator">+=</span>id<span class="token operator">+</span><span class="token string">&quot;,0,&quot;</span><span class="token operator">+</span>x<span class="token operator">+</span><span class="token string">&quot;,&quot;</span><span class="token operator">+</span>y<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>opt<span class="token operator">==</span><span class="token number">1</span><span class="token operator">||</span><span class="token punctuation">(</span>opt<span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">256</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">int</span> ind<span class="token operator">=</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token function">getAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">256</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> pointerCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span>ind<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">int</span> id <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getPointerId</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>isFirst<span class="token punctuation">)</span><span class="token punctuation">{</span>isFirst<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
                <span class="token keyword">else</span> rec<span class="token operator">+=</span><span class="token string">&quot;;&quot;</span><span class="token punctuation">;</span>
                rec<span class="token operator">+=</span>id<span class="token operator">+</span><span class="token string">&quot;,1&quot;</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h2 id="web"><a href="#web" class="header-anchor">#</a> Web</h2> <p>见另一篇文章<a href="http://hongweipeng.com/index.php/archives/838/" target="_blank" rel="noopener noreferrer">video标签下触摸坐标归一化<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="嵌入式设备"><a href="#嵌入式设备" class="header-anchor">#</a> 嵌入式设备</h2> <p>待研究</p> <h1 id="数据编码"><a href="#数据编码" class="header-anchor">#</a> 数据编码</h1> <p>最后数据以<code>ID,OPTION,X,Y</code>这样的字符串传输,多指操作通过<code>;</code>隔开</p> <ul><li><strong>OPTION:</strong> <code>0:DOWN</code>; <code>1:UP</code>;<code>2:MOVE</code></li> <li><strong>ID:</strong> 触点ID 通过<code>event.getPointerId</code> 获取， 对应服务器的<code>0x2f</code></li> <li><strong>X,Y</strong> 按道理范围应该在<code>[0,1]</code>;即本机分辨率的百分比。服务端再以该系数模拟。这边我们先假设两边机器一样，直接传实际int</li></ul> <h1 id="数据传输"><a href="#数据传输" class="header-anchor">#</a> 数据传输</h1> <h2 id="socket"><a href="#socket" class="header-anchor">#</a> socket</h2> <h3 id="客户端"><a href="#客户端" class="header-anchor">#</a> 客户端</h3> <p>1.在子线程中初始化<code>socket</code>和<code>Handler mHandler</code>
2.UI线程收到编码数据后，执行<code>mHandler.sendMessage(message)</code>操作
3.<code>Looper</code>在子线程的<code>mHandler</code>将会回调<code>handleMessage</code>，在这里进行socket传输</p> <p>代码：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>	<span class="token class-name">Socket</span> socket <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">BufferedWriter</span> writer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">BufferedReader</span> reader <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">MyHandler</span> <span class="token keyword">extends</span> <span class="token class-name">Handler</span> <span class="token punctuation">{</span>
        <span class="token comment">//这边这个looper参数是否应该软引用？</span>
        <span class="token keyword">public</span> <span class="token class-name">MyHandler</span><span class="token punctuation">(</span><span class="token class-name">Looper</span> looper<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>looper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//子线程收到数据，进行socket send data</span>
            <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">handleMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">&quot;RECEIVE&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;子线程收到:&quot;</span> <span class="token operator">+</span> msg<span class="token punctuation">.</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>obj <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//必须加上换行</span>
                writer<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">class</span> <span class="token class-name">SockRunnable</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
         <span class="token annotation punctuation">@Override</span>
         <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">&quot;THREAD&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;START&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token keyword">try</span> <span class="token punctuation">{</span>
                 socket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Socket</span><span class="token punctuation">(</span><span class="token string">&quot;192.168.191.1&quot;</span><span class="token punctuation">,</span> <span class="token number">12345</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OutputStreamWriter</span><span class="token punctuation">(</span>
                         socket<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>
                         socket<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">&quot;CONNECT&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;连接成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                 e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
             <span class="token keyword">try</span> <span class="token punctuation">{</span>
                 <span class="token class-name">Looper</span><span class="token punctuation">.</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token comment">//让MyHandle为子线程服务</span>
                 mHandler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyHandler</span><span class="token punctuation">(</span><span class="token class-name">Looper</span><span class="token punctuation">.</span><span class="token function">myLooper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 <span class="token class-name">Looper</span><span class="token punctuation">.</span><span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                 <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token string">&quot;zjx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
     <span class="token annotation punctuation">@Override</span>
     <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>mHandler <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             mHandler<span class="token punctuation">.</span><span class="token function">removeCallbacksAndMessages</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>writer <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             <span class="token keyword">try</span> <span class="token punctuation">{</span>
                 writer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                 reader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                 e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
             <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
     onCreate<span class="token punctuation">{</span>
     	<span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SockRunnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ReceiveData</span> rd<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ReceiveData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive</span><span class="token punctuation">(</span><span class="token class-name">String</span> json<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">&quot;SEND&quot;</span><span class="token punctuation">,</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">//ADD 时间轴</span>
                <span class="token comment">//MOVE数据的过滤 平方和&lt;12</span>
                <span class="token comment">//SOCKET数据发送</span>
                <span class="token class-name">Message</span> message<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                message<span class="token punctuation">.</span>obj<span class="token operator">=</span>json<span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>mHandler<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    mHandler<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
     
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br></div></div><h3 id="服务端"><a href="#服务端" class="header-anchor">#</a> 服务端</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServerListener</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>  
    	<span class="token annotation punctuation">@Override</span>  
    	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        	<span class="token keyword">try</span> <span class="token punctuation">{</span>  
            	<span class="token class-name">ServerSocket</span> serverSocket <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServerSocket</span><span class="token punctuation">(</span><span class="token number">12345</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        	    <span class="token comment">// 循环的监听  </span>
            	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
                	<span class="token class-name">Socket</span> socket <span class="token operator">=</span> serverSocket<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 阻塞  </span>
                	<span class="token class-name">JOptionPane</span><span class="token punctuation">.</span><span class="token function">showMessageDialog</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;有客户端连接到本机的12345端口！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                	<span class="token comment">// 将socket传给新的线程  </span>
                	<span class="token class-name">ChatSocket</span> cs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChatSocket</span><span class="token punctuation">(</span>socket<span class="token punctuation">)</span><span class="token punctuation">;</span>  
                	cs<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
                	<span class="token comment">//把socket加入ChatManager  </span>
                	<span class="token class-name">ChatManager</span><span class="token punctuation">.</span><span class="token function">getChatManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>cs<span class="token punctuation">)</span><span class="token punctuation">;</span>  
            	<span class="token punctuation">}</span>  
        	<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
            	e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        	<span class="token punctuation">}</span>  
    	<span class="token punctuation">}</span>  
	<span class="token punctuation">}</span>
	
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="datachannel"><a href="#datachannel" class="header-anchor">#</a> DataChannel</h2> <p>略</p> <h1 id="数据解码"><a href="#数据解码" class="header-anchor">#</a> 数据解码</h1> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">void</span> <span class="token function">decodeData</span><span class="token punctuation">(</span><span class="token class-name">String</span> json<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">String</span> ls<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> s <span class="token operator">:</span> ls<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">String</span> cs<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> id <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>cs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> opt <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>cs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">switch</span> <span class="token punctuation">(</span>opt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
			<span class="token function">sendDown</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> cs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cs<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
			<span class="token function">sendUp</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
			<span class="token function">sendMove</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> cs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cs<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h1 id="数据模拟"><a href="#数据模拟" class="header-anchor">#</a> 数据模拟</h1> <p>以下方式凡是利用sendevent的，都可以通过getevent回去到对应的指令</p> <p>而传入MotionEvent.obtain的，只能通过开启开发者选择的触点显示</p> <h2 id="_1-adb-shell"><a href="#_1-adb-shell" class="header-anchor">#</a> 1. adb shell</h2> <p>在 <code>system/core/include/private/android_filesystem_config.h</code> 中定义了Android的用户和组</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment">#define AID_SHELL 2000 /* adb and debug shell user UID=2000*/</span>
<span class="token comment">#即</span>
root uid <span class="token number">0</span> gid0 
system uid <span class="token number">1000</span> gid1000
shell uid <span class="token number">2000</span> gid2000
app uid <span class="token operator">&gt;</span><span class="token number">10000</span> gid <span class="token operator">&gt;</span><span class="token number">10000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>同时我们执行以下命令（<a href="http://www.linuxidc.com/Linux/2012-09/70492.htm" target="_blank" rel="noopener noreferrer">ls -l命令详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>shell@android:/dev/input $ <span class="token function">ls</span> <span class="token parameter variable">-l</span>
crw-rw---- root     	input     	<span class="token number">13</span>,  <span class="token number">64</span> <span class="token number">2016</span>-11-18 08:17 event0
crw-rw---- root     	input     	<span class="token number">13</span>,  <span class="token number">65</span> <span class="token number">2016</span>-11-18 08:17 event1
crw-rw---- root     	input     	<span class="token number">13</span>,  <span class="token number">66</span> <span class="token number">2016</span>-11-18 08:17 event2
crw-rw---- root     	input     	<span class="token number">13</span>,  <span class="token number">67</span> <span class="token number">2016</span>-11-18 08:17 event3
文件属性	   文件拥有者     拥有者所在主组							    文件名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>我们发现input组是拥有 <code>rw-</code> 权限的。</p> <p>通过运行id命令得到如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>shell@android:/ $ id
uid=2000(shell) gid=2000(shell) groups=1003(graphics),1004(input),1007(log),1009
(mount),1011(adb),1015(sdcard_rw),1028(sdcard_r),3001(net_bt_admin),3002(net_bt)
,3003(inet),3006(net_bw_stats)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>shell属于input组，那么shell也就拥有<code>rw-</code>的权限,意思就是说shell用户(or其运行的程序)可以对eventX文件进行读写</p> <p>那么读写的形式就有以下两种了：</p> <h3 id="_1-1-server端执行shell脚本"><a href="#_1-1-server端执行shell脚本" class="header-anchor">#</a> 1.1 server端执行shell脚本</h3> <h4 id="大致流程"><a href="#大致流程" class="header-anchor">#</a> <strong>大致流程：</strong></h4> <p>Java的话可采用Runtime</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>process <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&quot;adb shell&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 获取输出流</span>
outputStream <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dataOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataOutputStream</span><span class="token punctuation">(</span>outputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 执行cmd指令，例： cmd=&quot;sendevent /dev/input/event3 0 0 0&quot;;</span>
dataOutputStream<span class="token punctuation">.</span><span class="token function">writeBytes</span><span class="token punctuation">(</span>cmd <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="实现难度-5-5"><a href="#实现难度-5-5" class="header-anchor">#</a> <strong>实现难度：5/5</strong></h4> <p>实现简单，代码量少。多种语言均支持执行shell命令</p> <h4 id="维护拓展-1-5"><a href="#维护拓展-1-5" class="header-anchor">#</a> <strong>维护拓展： 1/5</strong></h4> <p>Runtime会间接性出问题(原因未明)</p> <p>dataOutputStream操作会堵塞本地IO通道，不适合多开。</p> <p>Java执行跨平台，易迁移，给1星。</p> <h4 id="需要root-否"><a href="#需要root-否" class="header-anchor">#</a> <strong>需要root？</strong> 否</h4> <h4 id="效率延迟-1-5"><a href="#效率延迟-1-5" class="header-anchor">#</a> <strong>效率延迟：1/5</strong></h4> <p>效率极差，<strong><code>指令组</code></strong>（单指move,down,up等操作称为指令组，包含多条sendevent基础指令）<strong><code>响应时间</code></strong>(指令执行时间间隔)&gt;200ms</p> <h4 id="推荐指数-1-5"><a href="#推荐指数-1-5" class="header-anchor">#</a> <strong>推荐指数：</strong> 1/5</h4> <h3 id="_1-2-android端执行adb-shell用户启动的程序"><a href="#_1-2-android端执行adb-shell用户启动的程序" class="header-anchor">#</a> 1.2 android端执行adb shell用户启动的程序</h3> <h4 id="大致流程-2"><a href="#大致流程-2" class="header-anchor">#</a> <strong>大致流程：</strong></h4> <p>1.编写C socket程序<code>minitouch</code>，并放到<code>/data/local/tmp/</code> 目录(<code>user,group=shell</code>)下</p> <p>2.chmod 777该文件后，run它</p> <p>3.执行以下命令：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>adb forward tcp:1111 localabstract:minitouch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>表示server本地的1111端口会映射到minitouch上</p> <p>4.本地利用socket通信发送数据到1111端口，minitouch进一步处理</p> <p><em>以上只是大致流程，minitouch还涉及到abi和sdk的版本的处理</em></p> <p><a href="https://github.com/openstf/minitouch" target="_blank" rel="noopener noreferrer">开源实现minitouch<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://testerhome.com/topics/4400" target="_blank" rel="noopener noreferrer">minitouch使用流程，minitap开源项目类似 也可采用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="实现难度-4-5"><a href="#实现难度-4-5" class="header-anchor">#</a> <strong>实现难度：4/5</strong></h4> <p>需要编写两端程序：放于android的socket程序，本地发送数据程序。</p> <p>相对简单，且有开源实现。</p> <h4 id="维护拓展-4-5"><a href="#维护拓展-4-5" class="header-anchor">#</a> <strong>维护拓展： 4/5</strong></h4> <p>分配本地端口并转发到android socket程序上，端口是足够用的，只要设置规范不会产生冲突</p> <h4 id="需要root-否-2"><a href="#需要root-否-2" class="header-anchor">#</a> <strong>需要root？</strong> 否</h4> <p><code>sdk 10-21</code> 无需root,<code>21+</code>需要root,<code>sdk 20 Android Wear</code> 需要root</p> <h4 id="效率延迟-5-5"><a href="#效率延迟-5-5" class="header-anchor">#</a> <strong>效率延迟：5/5</strong></h4> <p><strong><code>指令组响应时间</code></strong>&lt;10ms</p> <h4 id="推荐指数-4-5-5"><a href="#推荐指数-4-5-5" class="header-anchor">#</a> <strong>推荐指数：</strong> 4.5/5</h4> <h2 id="_2-android端-root-sendevent"><a href="#_2-android端-root-sendevent" class="header-anchor">#</a> 2. Android端 root sendevent</h2> <h3 id="_2-1-runtime-getruntime-exec-su"><a href="#_2-1-runtime-getruntime-exec-su" class="header-anchor">#</a> 2.1 Runtime.getRuntime().exec(&quot;su&quot;)</h3> <h4 id="大致流程-3"><a href="#大致流程-3" class="header-anchor">#</a> 大致流程：</h4> <p>Android端获取su权限后，利用Runtime执行sendevent命令</p> <p>这里的cmds 可以是<code>sendevent</code> 也可以是<code>input swipe</code></p> <p>注：input swipe 即提供两点坐标 然后move且只能单指</p> <p>也就是说要等一个完整的DOWN-MOVE-UP过程 然后发送起始-终点位置。</p> <p>与其这样 还不如用sendevent 优化move间隔</p> <p>getevent获取不到触控信息。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">execShellCmd</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cmds<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">Process</span> process <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">&quot;su&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">DataOutputStream</span> os <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataOutputStream</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> tmpCmd <span class="token operator">:</span> cmds<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        os<span class="token punctuation">.</span><span class="token function">writeBytes</span><span class="token punctuation">(</span>tmpCmd <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    os<span class="token punctuation">.</span><span class="token function">writeBytes</span><span class="token punctuation">(</span><span class="token string">&quot;exit\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    os<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    process<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="实现难度-5-5-2"><a href="#实现难度-5-5-2" class="header-anchor">#</a> <strong>实现难度：5/5</strong></h4> <p>实现简单，代码量少。</p> <h4 id="维护拓展-1-5-2"><a href="#维护拓展-1-5-2" class="header-anchor">#</a> <strong>维护拓展：1/5</strong></h4> <p>同1.1,区别只是程序运行与Android端。</p> <h4 id="需要root-是"><a href="#需要root-是" class="header-anchor">#</a> <strong>需要root？</strong> 是</h4> <h4 id="效率延迟-1-5-2"><a href="#效率延迟-1-5-2" class="header-anchor">#</a> <strong>效率延迟：1/5</strong></h4> <p><strong><code>指令组响应时间</code></strong>&gt;200ms</p> <h4 id="推荐指数-1-5-2"><a href="#推荐指数-1-5-2" class="header-anchor">#</a> <strong>推荐指数：</strong> 1/5</h4> <h3 id="_2-2-linux-c"><a href="#_2-2-linux-c" class="header-anchor">#</a> 2.2 linux c</h3> <p>由于我们是自己编译Android系统，所以我们可以写个linux C socket程序放在Android里</p> <p>linux C socket编程这边不提及，我们假设取得解码的值了</p> <p>编写如下文件</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;jni.h&gt;</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;android/log.h&gt;</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h&gt;</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;errno.h&gt;</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h&gt;</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h&gt;</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h&gt;</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;linux/input.h&gt;</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/time.h&gt;</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/types.h&gt;</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">LOG_TAG</span> <span class="token string">&quot;ZJX&quot;</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ABS_MT_SLOT</span> <span class="token expression"><span class="token number">0x2f</span></span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ABS_MT_TOUCH_MAJOR</span> <span class="token expression"><span class="token number">0x30</span></span></span>
	<span class="token comment">/* WARNING: DO NOT EDIT, AUTO-GENERATED CODE - SEE TOP FOR INSTRUCTIONS */</span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ABS_MT_TOUCH_MINOR</span> <span class="token expression"><span class="token number">0x31</span></span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ABS_MT_WIDTH_MAJOR</span> <span class="token expression"><span class="token number">0x32</span></span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ABS_MT_WIDTH_MINOR</span> <span class="token expression"><span class="token number">0x33</span></span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ABS_MT_ORIENTATION</span> <span class="token expression"><span class="token number">0x34</span></span></span>
	<span class="token comment">/* WARNING: DO NOT EDIT, AUTO-GENERATED CODE - SEE TOP FOR INSTRUCTIONS */</span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ABS_MT_POSITION_X</span> <span class="token expression"><span class="token number">0x35</span></span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ABS_MT_POSITION_Y</span> <span class="token expression"><span class="token number">0x36</span></span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ABS_MT_TOOL_TYPE</span> <span class="token expression"><span class="token number">0x37</span></span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ABS_MT_BLOB_ID</span> <span class="token expression"><span class="token number">0x38</span></span></span>
	<span class="token comment">/* WARNING: DO NOT EDIT, AUTO-GENERATED CODE - SEE TOP FOR INSTRUCTIONS */</span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ABS_MT_TRACKING_ID</span> <span class="token expression"><span class="token number">0x39</span></span></span>
	
	<span class="token keyword">int</span> finger_count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> fd_touch<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> finger_id<span class="token operator">=</span><span class="token number">520</span><span class="token punctuation">;</span>
	
	<span class="token keyword">void</span> <span class="token function">sendEvent</span><span class="token punctuation">(</span>__u16 type<span class="token punctuation">,</span>__u16 code<span class="token punctuation">,</span><span class="token keyword">int</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>
	    <span class="token keyword">struct</span> <span class="token class-name">input_event</span> event<span class="token punctuation">;</span>
	    event<span class="token punctuation">.</span>type <span class="token operator">=</span> type<span class="token punctuation">;</span>
	    event<span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
	    event<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
		<span class="token comment">//    gettimeofday(&amp;event.time,0);</span>
		<span class="token function">write</span><span class="token punctuation">(</span>fd_touch<span class="token punctuation">,</span> <span class="token operator">&amp;</span>event<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">void</span> <span class="token function">touchMove</span><span class="token punctuation">(</span><span class="token keyword">int</span> finger_index<span class="token punctuation">,</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">{</span>
	    <span class="token function">sendEvent</span><span class="token punctuation">(</span> EV_ABS<span class="token punctuation">,</span>ABS_MT_SLOT<span class="token punctuation">,</span>finger_index<span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token function">sendEvent</span><span class="token punctuation">(</span> EV_ABS<span class="token punctuation">,</span> ABS_MT_POSITION_X<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token function">sendEvent</span><span class="token punctuation">(</span> EV_ABS<span class="token punctuation">,</span> ABS_MT_POSITION_Y<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token function">sendEvent</span><span class="token punctuation">(</span> EV_SYN<span class="token punctuation">,</span> SYN_REPORT<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">touchDown</span><span class="token punctuation">(</span><span class="token keyword">int</span> finger_index<span class="token punctuation">,</span><span class="token keyword">int</span> x<span class="token punctuation">,</span><span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">{</span>
	    finger_count<span class="token operator">++</span><span class="token punctuation">;</span>
	    <span class="token function">sendEvent</span><span class="token punctuation">(</span> EV_ABS<span class="token punctuation">,</span> ABS_MT_SLOT<span class="token punctuation">,</span> finger_index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token comment">//需要指定ABS_MT_TRACKING_ID，否则sendevent( EV_ABS, ABS_MT_TRACKING_ID, -1);不会生效</span>
    	<span class="token function">sendEvent</span><span class="token punctuation">(</span> EV_ABS<span class="token punctuation">,</span> ABS_MT_TRACKING_ID<span class="token punctuation">,</span> finger_id<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token function">sendEvent</span><span class="token punctuation">(</span> EV_ABS<span class="token punctuation">,</span> ABS_MT_POSITION_X<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token function">sendEvent</span><span class="token punctuation">(</span> EV_ABS<span class="token punctuation">,</span> ABS_MT_POSITION_Y<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span>finger_count<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    	    <span class="token function">sendEvent</span><span class="token punctuation">(</span> EV_KEY<span class="token punctuation">,</span> BTN_TOUCH<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
    	<span class="token function">sendEvent</span><span class="token punctuation">(</span> EV_SYN<span class="token punctuation">,</span> SYN_REPORT<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">void</span> <span class="token function">touchUp</span><span class="token punctuation">(</span><span class="token keyword">int</span> finger_index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	finger_count<span class="token operator">--</span><span class="token punctuation">;</span>
    	<span class="token function">sendEvent</span><span class="token punctuation">(</span> EV_ABS<span class="token punctuation">,</span> ABS_MT_SLOT<span class="token punctuation">,</span> finger_index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token function">sendEvent</span><span class="token punctuation">(</span> EV_ABS<span class="token punctuation">,</span> ABS_MT_TRACKING_ID<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span>finger_count<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    	    <span class="token function">sendEvent</span><span class="token punctuation">(</span> EV_KEY<span class="token punctuation">,</span> BTN_TOUCH<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
    	<span class="token function">sendEvent</span><span class="token punctuation">(</span> EV_SYN<span class="token punctuation">,</span> SYN_REPORT<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><p>在main写个测试</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>	<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		fd_touch <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;/dev/input/event3&quot;</span><span class="token punctuation">,</span> O_RDWR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token keyword">if</span><span class="token punctuation">(</span>fd_touch<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        	<span class="token keyword">return</span> env<span class="token operator">-&gt;</span><span class="token function">NewStringUTF</span><span class="token punctuation">(</span><span class="token function">strerror</span><span class="token punctuation">(</span>errno<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    	<span class="token punctuation">}</span>
     	<span class="token function">touchDown</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">380</span><span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//     touchDown(1,250,250);</span>
	
	     <span class="token function">touchMove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//     touchMove(1,350,350);</span>
	     <span class="token function">touchMove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//     touchMove(1,300,500);</span>
	     <span class="token function">touchMove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">350</span><span class="token punctuation">,</span><span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//     touchMove(1,250,250);</span>
	     <span class="token function">touchMove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	     <span class="token function">touchUp</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//     touchUp(1);</span>
    	<span class="token function">close</span><span class="token punctuation">(</span>fd_touch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
	<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><blockquote><p>这边我们是一接受到socket传来的值后，就进行处理，那么需要给inpue_event赋值time属性吗？</p></blockquote> <p>不用赋值。做了下测试，感觉没赋值的话写入时默认就是当前时间，具体event文件读写原理有空再看。或者懂的大牛告诉我下。</p> <blockquote><p>如果是自己写的程序想模拟长按，是通过赋值time还是Thread.sleep?</p></blockquote> <p>如果想做延迟，要在上一层去做，而不是赋值time或者在本层堵塞线程,上一层做更安全。</p> <blockquote><p>测试的时候，打印了onTouch(MotionEvent ev)中ev的值，发现部分move事件没找到，是被丢弃了吗？</p></blockquote> <p>并不是，打印getevent就找到是都会响应的。</p> <p>只是由于指令太快 Move会进行合并，onTouch中打印getHistorySize就明白了</p> <p>所以不要因为测试的时候画板画出来的不是我们想要的路线就以为是数据被丢掉了- -</p> <h4 id="实现难度-4-5-5"><a href="#实现难度-4-5-5" class="header-anchor">#</a> <strong>实现难度：4.5/5</strong></h4> <p>实现简单，代码量少。只要懂C Socket编程就可以了。</p> <h4 id="维护拓展-3-5-5"><a href="#维护拓展-3-5-5" class="header-anchor">#</a> <strong>维护拓展：3.5/5</strong></h4> <p>需要在自编译的android系统上，以input组用户运行</p> <p>或者在非自编译系统采用1.2的做法</p> <h4 id="需要root-不确定"><a href="#需要root-不确定" class="header-anchor">#</a> <strong>需要root？</strong> 不确定</h4> <p>自编译的系统，可以以shell用户写eventX文件</p> <p>当然最方便还是直接用root啦</p> <h4 id="效率延迟-5-5-2"><a href="#效率延迟-5-5-2" class="header-anchor">#</a> <strong>效率延迟：5/5</strong></h4> <p><strong><code>指令组响应时间</code></strong>&lt;10ms</p> <h4 id="推荐指数-4-7-5"><a href="#推荐指数-4-7-5" class="header-anchor">#</a> <strong>推荐指数：</strong> 4.7/5</h4> <h3 id="_2-3-jni"><a href="#_2-3-jni" class="header-anchor">#</a> 2.3  jni</h3> <p>数据处理与<strong>2.2</strong>一致，只是socket是Android Service去做的，通过jni调用</p> <p>做法：</p> <p>1.先修改文件权限</p> <div class="language- extra-class"><pre><code>shell@android:/ $ su			
root@android:/ # chmod 777 /dev/input/event3  注 Android 5.x 由于SELinux?还是权限受限
</code></pre></div><p>2.然后往<code>/dev/input/eventX</code>写数据就好了</p> <div class="language- extra-class"><pre><code>extern &quot;C&quot;
jstring Java_com_example_zhengjx_myapplication_MainActivity_sendEvent2(
    JNIEnv* env,
    jobject obj,jint type,jint a,jint b,jint c) {
	char *hello = &quot;Hello from C++&quot;;
	fd_touch = open(&quot;/dev/input/event3&quot;, O_RDWR);
	if(fd_touch&lt;=0) {
	    return env-&gt;NewStringUTF(strerror(errno));
	}
	//将系统当前时间以结构体形式返回给cur,初始时间戳
	struct timeval cur;
	gettimeofday(&amp;cur, NULL);
	switch (type){
	    case 0:touchDown(a,b,c);break;
	    case 1:touchUp(a);break;
	    case 2:touchMove(a,b,c);break;
	}
	close(fd_touch);
	return env-&gt;NewStringUTF(hello);
}
</code></pre></div><p>TEST:</p> <div class="language- extra-class"><pre><code>                        sendEvent2(0,0,380,400);
                        sendEvent2(2,0,300,300);
                        sendEvent2(2,0,200,400);
                        sendEvent2(2,0,350,250);
                        sendEvent2(2,0,400,600);
                        sendEvent2(1,0,0,0);
</code></pre></div><blockquote><p>与2.2相比就是多了一个jni调用的耗时(该部分耗时&lt;10ms)</p></blockquote> <p>为了不让eventX 做move优化，该部分耗时反而是好的,测试的时候每条move指令都会响应，基本不会进行move合并。</p> <p>另外记得把event3文件开成全局的，防止每次都要创建 关闭流的耗时- -，而且不知道会不会有什么影响</p> <blockquote><p>5.x chmod 777 后权限受限问题</p></blockquote> <p>按解决问题的想法，不用root的方法我们用adb shell不会出现这问题，需要root的我们直接linux C，这方法没有什么价值。</p> <h4 id="实现难度-5-5-3"><a href="#实现难度-5-5-3" class="header-anchor">#</a> <strong>实现难度：5/5</strong></h4> <p>实现简单，代码量少。</p> <h4 id="维护拓展-4-5-2"><a href="#维护拓展-4-5-2" class="header-anchor">#</a> <strong>维护拓展：4/5</strong></h4> <p>5.X 的 权限受限问题，正在研究解决方案。。</p> <h4 id="需要root-需要"><a href="#需要root-需要" class="header-anchor">#</a> <strong>需要root？</strong> 需要</h4> <p>需要root用户先将eventX文件属性改为777</p> <h4 id="效率延迟-5-5-3"><a href="#效率延迟-5-5-3" class="header-anchor">#</a> <strong>效率延迟：5/5</strong></h4> <p>**<code>指令组响应时间</code>**≈10ms</p> <h4 id="推荐指数-4-7-5-2"><a href="#推荐指数-4-7-5-2" class="header-anchor">#</a> <strong>推荐指数：</strong> 4.7/5</h4> <h3 id="_2-4-roottools"><a href="#_2-4-roottools" class="header-anchor">#</a> 2.4  RootTools</h3> <p>RootTools是一个用于执行linux指令的<a href="https://github.com/Stericson/RootTools" target="_blank" rel="noopener noreferrer">开源工具<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>用法：</p> <div class="language- extra-class"><pre><code>CommandCapture cmd = new CommandCapture(0, &quot;sendevent /dev/input/event3 0 0 &quot;);
RootTools.getShell(true).add(cmd);
</code></pre></div><p>大致研究了下，是通过线程池顺序执行指令，效率又比Rumtime高那么一点点</p> <h4 id="实现难度-5-5-4"><a href="#实现难度-5-5-4" class="header-anchor">#</a> <strong>实现难度：5/5</strong></h4> <p>实现简单，代码量少。</p> <h4 id="维护拓展-5-5"><a href="#维护拓展-5-5" class="header-anchor">#</a> <strong>维护拓展：5/5</strong></h4> <h4 id="需要root-是-2"><a href="#需要root-是-2" class="header-anchor">#</a> <strong>需要root？</strong> 是</h4> <h4 id="效率延迟-2-5"><a href="#效率延迟-2-5" class="header-anchor">#</a> <strong>效率延迟：2/5</strong></h4> <p><strong><code>指令组响应时间</code></strong> :指令组中指令数量：1条100ms 2条120-200ms 3+:200+ms</p> <h4 id="推荐指数-2-5"><a href="#推荐指数-2-5" class="header-anchor">#</a> <strong>推荐指数：</strong> 2/5</h4> <h2 id="_3-motionevent-obtain"><a href="#_3-motionevent-obtain" class="header-anchor">#</a> 3. MotionEvent.obtain</h2> <h3 id="_3-1-instrumentation"><a href="#_3-1-instrumentation" class="header-anchor">#</a> 3.1 Instrumentation</h3> <h4 id="大致流程-4"><a href="#大致流程-4" class="header-anchor">#</a> 大致流程</h4> <div class="language- extra-class"><pre><code>Instrumentation m_Instrumentation = new Instrumentation();
long downTime = SystemClock.uptimeMillis();
long eventTime = SystemClock.uptimeMillis() + 100;
long eventTime2 = SystemClock.uptimeMillis() + 200;
float x=200.0f;
float y=280.0f;
m_Instrumentation.sendPointerSync(MotionEvent.obtain(downTime,
downTime,MotionEvent.ACTION_DOWN,x, y, 0));
for(int i=1;i&lt;=50;i++){
    m_Instrumentation.sendPointerSync(MotionEvent.obtain(downTime,
		SystemClock.uptimeMillis(),MotionEvent.ACTION_MOVE,x+i, y, 0));
}
for(int i=1;i&lt;=50;i++){
	m_Instrumentation.sendPointerSync(MotionEvent.obtain(downTime,
		SystemClock.uptimeMillis(),MotionEvent.ACTION_MOVE,x+50, y+i, 0));
}
for(int i=50;i&gt;=1;i--){
	m_Instrumentation.sendPointerSync(MotionEvent.obtain(downTime,
		SystemClock.uptimeMillis(),MotionEvent.ACTION_MOVE,x+i, y+50, 0));
}
for(int i=50;i&gt;=1;i--){
	m_Instrumentation.sendPointerSync(MotionEvent.obtain(downTime,
		SystemClock.uptimeMillis(),MotionEvent.ACTION_MOVE,x, y+i, 0));
}
m_Instrumentation.sendPointerSync(MotionEvent.obtain(downTime,
	eventTime2,MotionEvent.ACTION_UP,550, 550, 0));
</code></pre></div><p>API是开放的</p> <p>在其他应用上使用会出现这样的提示：</p> <p><code>java.lang.SecurityException: Injecting to another application requires INJECT_EVENTS permission</code></p> <p><code>http://stackoverflow.com/questions/22163424/android-java-lang-securityexception-injecting-to-another-application-requires</code> 无解</p> <p>添加权限无效，必须将该应用置为system应用.</p> <p>底层还是基于IwindowManager 去做的，这边我们不再分析直接讨论3.2</p> <h3 id="_3-2-iwindowmanager"><a href="#_3-2-iwindowmanager" class="header-anchor">#</a> 3.2 IWindowManager</h3> <p>monkey，Robotium就是基于它做的</p> <div class="language- extra-class"><pre><code>IWindowManager.Stub.asInterface(ServiceManager
               .getService(&quot;window&quot;))).injectPointerEvent(event, true);
</code></pre></div><p>从API 8开始IWindowManager接口就被屏蔽掉了，没有这个API直接调用。</p> <p>可以源码编译生成jar包 root权限下降jar导入	<code>/system/framework/</code>下，或者直接用反射(效率差点)</p> <p>如何跳出进程间限制？<a href="http://blog.csdn.net/zhubaitian/article/details/40430053" target="_blank" rel="noopener noreferrer">该篇译文给出了链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="实现难度-4-5-2"><a href="#实现难度-4-5-2" class="header-anchor">#</a> <strong>实现难度：4/5</strong></h4> <p>主要是多指的代码会比较多和复杂，不易封装。</p> <p>没有提供内部接口的问题解决方案也给出了，或者直接用<code>Instrumentation</code>。</p> <h4 id="维护拓展-4-5-3"><a href="#维护拓展-4-5-3" class="header-anchor">#</a> <strong>维护拓展：4/5</strong></h4> <p>研究的不深，可能有些坑存在</p> <h4 id="需要root-否-3"><a href="#需要root-否-3" class="header-anchor">#</a> <strong>需要root？</strong> 否</h4> <p>但是应用需要拥有system权限</p> <h4 id="效率延迟-3-5-5"><a href="#效率延迟-3-5-5" class="header-anchor">#</a> <strong>效率延迟：3.5/5</strong></h4> <p>**<code>指令组响应时间</code>**20~50ms</p> <h4 id="推荐指数-4-5"><a href="#推荐指数-4-5" class="header-anchor">#</a> <strong>推荐指数：</strong> 4/5</h4> <h2 id="accessibilityservice"><a href="#accessibilityservice" class="header-anchor">#</a> Accessibilityservice</h2> <p>借助Android提供的无障碍服务
在<code>res/xml</code>目录下新建一个<code>accessibility_service_config.xml</code>文件</p> <div class="language- extra-class"><pre><code>&lt;intent-filter&gt;
	&lt;action android:name=&quot;android.accessibilityservice.AccessibilityService&quot; /&gt;
&lt;/intent-filter&gt;
</code></pre></div><p><code>http://blog.csdn.net/sinyu890807/article/details/47803149</code></p> <p>实现要各种判断:</p> <div class="language- extra-class"><pre><code>窗口名太多 手动生成accessibility_service_config再service手动Intent注入action不太合适
然后操作节点等又是很麻烦的一件事：适合对已知节点操作，不适合模拟
</code></pre></div><p><strong>(弃</strong></p> <p>其他：非root方法</p> <p>通过hook方法绕过权限验证</p> <div class="language- extra-class"><pre><code>//http://blog.sina.com.cn/s/blog_151b043850102wiv9.html
</code></pre></div><p>以后有空再研究</p> <h1 id="附录"><a href="#附录" class="header-anchor">#</a> 附录</h1> <p>sendevent.c
http://www.netmite.com/android/mydroid/system/core/toolbox/sendevent.c
http://androidxref.com/4.4.4_r1/xref/system/core/toolbox/getevent.c</p> <h1 id="防退出全屏"><a href="#防退出全屏" class="header-anchor">#</a> 防退出全屏</h1> <p>1.状态栏</p> <h2 id="纯客户端去做"><a href="#纯客户端去做" class="header-anchor">#</a> 纯客户端去做</h2> <p>目前比较简单的定义是：
当TOUCH_DOWN处于 纵坐标0.9-1.0区域时，将此时的事件放入buffer,
接下来的操作，如果为TOUCH_MOVE,且其坐标在TOUCH_DOWN的坐标上方，都将放入buffer。</p> <p><strong>客户端去做不太可行 一些奇怪的手势不能过滤掉</strong></p> <h2 id="做一个系统应用-需要有系统签名"><a href="#做一个系统应用-需要有系统签名" class="header-anchor">#</a> 做一个系统应用，需要有系统签名</h2> <div class="language- extra-class"><pre><code>   1   public static final void collapseStatusBar(Context ctx) {
   2   Object sbservice = ctx.getSystemService(&quot;statusbar&quot;);
   3   try {
   4   Class&lt;?&gt; statusBarManager = Class.forName(&quot;android.app.StatusBarManager&quot;);
   5   Method collapse;
   6   if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.JELLY_BEAN_MR1) {
   7   collapse = statusBarManager.getMethod(&quot;collapsePanels&quot;);
   8   } else {
   9   collapse = statusBarManager.getMethod(&quot;collapse&quot;);
  10   }
  11   collapse.invoke(sbservice);
  12   } catch (Exception e) {
  13   e.printStackTrace();
  14   }
  15   }
</code></pre></div><p>collapse只是折叠状态栏，还是能强行拖动下拉，不能根本的屏蔽</p> <p>需要调用disable方法</p> <div class="language- extra-class"><pre><code>@Override
protected void onResume() {
    Toast.makeText(this,&quot;onResume&quot;,Toast.LENGTH_LONG).show();
    Object service = getSystemService(&quot;statusbar&quot;);
    try {
        Class &lt;?&gt; statusBarManager = Class.forName(&quot;android.app.StatusBarManager&quot;);
        Method expand = statusBarManager.getMethod(&quot;disable&quot;,int.class);
        expand.invoke (service,0x00010000);
        Toast.makeText(this,&quot;success&quot;,Toast.LENGTH_LONG).show();
    } catch (Exception e) {
        Toast.makeText(this,e.toString(),Toast.LENGTH_LONG).show();
        e.printStackTrace();
    }
    super.onResume();
}
@Override
protected void onDestroy() {
    //解除禁止，反射 mStatusBarManager.disable(StatusBarManager.DISABLE_NONE);0x00000000
    super.onDestroy();
}


package=&quot;com.ws.tryplayservice&quot; android:sharedUserId=&quot;android.uid.system&quot;&gt;
&lt;uses-permission android:name=&quot;android.permission.STATUS_BAR&quot; /&gt;
&lt;uses-permission android:name=&quot;android.permission.EXPAND_STATUS_BAR&quot; /&gt;
</code></pre></div><p>2.底部导航栏</p> <p>需求是不让导航栏显示，也就是我们的虚拟按键按键不显示，那么在模拟器配置HardWare Profiel中开启硬件按钮（Has HardWare Button）</p> <h1 id="捕获基本知识"><a href="#捕获基本知识" class="header-anchor">#</a> 捕获基本知识</h1> <div class="language- extra-class"><pre><code>    //ACTION_POINTER_i_DOWN:5 261 517 773 存在触点的情况下 DOWN
    //ACTION_POINTER_i_UP:6 262 518 774   存在触点的情况下 UP
    //每次UP时返回index后，再次UP时系统会重做填充，
    //即按顺序1 2 3 4 DOWN后， UP了1 返回6 此时UP 2 返回的还是6 说明再次UP时会把触点INDEX往前填充
    //多个触点时，UP第一个返回的是6，但是只有一个触点时返回的是2
    //按顺序1 2 3 4 DOWN后，UP 1返回6，此时再DOWN 5返回的是5，说明再次DOWN会从头找开始填充
    //UP时，通过event.getPointerCount()得到的数量不会变，只有再次才会更新，因为我们需要得到UP点的x,y等信息
    // DOWN 0 1 2 后 UP 了 1 此时剩 0 2 getPointerId(1)可以返回index=1的点id为2
    //需要理清的是pointerIndex与pointerID非等同
    //非MOVE事件，触点坐标也可能改变。例：1 2指按，1指抬，ACTION=6 此时获取2指的x,y可能会与1指未抬时的位置不一致
    //因为触摸屏是按一定时间间隔的，在这很小的时间间隔内，同时出现了MOVE和UP,优先UP,所以ACTION=UP 但是位置还是会移动
    //压力 等传感器 暂时不考虑，触摸点直径也暂时不考虑
    //出现哪些事件需要发数据，发什么数据？与sendEvent对应
    //0.(重)进游戏界面时，发送清空所有触点的指令
    //1.DOWN  or UP 发其位置 SENDEVENT 1 or 0 具体数据 同时更新 删除数组数据
    //2.MOVE  按ID得到新的位置 与之前进行比较
</code></pre></div><h1 id="捕获时异常"><a href="#捕获时异常" class="header-anchor">#</a> 捕获时异常</h1> <p>单指下：
在GameView中滑动时(DOWN在GameView中) 能够捕获到touch信息，滑动到GameView外也能捕获到MOVE,UP信息。
而从GameView外滑进GameView(down在GameView外)捕获不到touch信息</p> <p>多指：
若已有一个触点在GameView内（可以捕获到touch信息），另一个触点从GameView外滑入。也是可以捕获得到另一个触点的touch信息。
因为第二个触点的down不是TOUCH_DOWN 而是 TOUCH_POINTER_DOWN</p> <p>总的来说，只要有touchdown事件，直接对屏幕的操作都能被捕获到</p> <p>如果从画面外开始的touch都过滤的话 操作如下：</p> <p>onTouch放在GameView上监听</p> <p>if(opt=touch_down){
正常发送
}
else if(opt=touch_up){
正常发送
}
else if(opt=touch_move){
for(){
if(ID处于黑名单)该id的move不发送
else 正常发送
}
}else if(opt=touch_pointer_down){
if(down坐标处于GameView之外)将该id放入黑名单
else 正常发送
}else if(opt=touch_pointer_up){
if(id处于黑名单)则该id的up不发送
else 正常发送
}</p> <p>如果要保留从画面外开始的touch,直到画面内才开始捕获：</p> <p>onTouch放在GameView的外层GameViewLayout上去监听</p> <div class="language- extra-class"><pre><code>			int opt = event.getAction();
            Log.d(TAG, &quot;onTouch: &quot; + opt);
            if (opt == 2) {
                List&lt;TouchEvent&gt; whiteList = new ArrayList();
                for (int i = 0; i &lt; pointerCount; i++) {
                    int id = event.getPointerId(i);
                    float x = event.getX(i);
                    float y = event.getY(i);
                    //if id位于灰名单，如果move进GameView则需要补上down事件,并从灰名单中删除
                    //else 放入白名单，最后list发送
                    if (graySet.contains(id)) {
                        //不位于GameView则不处理
                        if (locateGameView(x, y)) {
                            //之前未发过down则发送down事件
                            receiveData(new TouchEvent(id, 0, x, y));
                            graySet.remove(id);
                            receiveData(new SyncEvent(pointerCount-graySet.size()));
                        }
                    } else {
                        whiteList.add(new TouchEvent(id, 2, x, y));
                    }
                }
                if (whiteList != null &amp;&amp; whiteList.size() &gt; 0) {
                    receiveData(whiteList);
                }
            } else if (opt == 0 || (opt - 5) % 256 == 0) {
                //为了简化，我们假设这过程不会进行MOVE
                //ind 指当前触摸序列的索引值，不一定连续
                //获取id还得通过getPointerId
                int ind = (event.getAction() - 5) / 256;
                int id = event.getPointerId(ind);
                float x = event.getX(ind);
                float y = event.getY(ind);
                if (!locateGameView(x, y)) {
                    //将该id放入灰名单
                    Log.d(TAG, &quot;receiveData:graySet.add&quot;);
                    graySet.add(id);
                } else {
                    receiveData(new TouchEvent(id, 0, x, y));
                    receiveData(new SyncEvent(pointerCount-graySet.size()));
                }
            } else if (opt == 1 || (opt - 6) % 256 == 0) {
                int ind = (event.getAction() - 6) / 256;
                int id = event.getPointerId(ind);
                //if 处于灰名单 移除
                //else 发送up事件
                if (!graySet.contains(id)) {
                    receiveData(new TouchEvent(id, 1, 0, 0));
                    receiveData(new SyncEvent(pointerCount -graySet.size() - 1));
                }else{
                    graySet.remove(id);
                }
            }
</code></pre></div><h1 id="模拟器不支持muiti-touch"><a href="#模拟器不支持muiti-touch" class="header-anchor">#</a> 模拟器不支持Muiti-Touch</h1> <p>一开始以为要升级模拟器版本，好像是不同模拟器默认的触控协议不一样，我们的方式的话要用B协议，A协议的话代码需要修改。</p> <p>SYN_EVENT里面有</p> <div class="language- extra-class"><pre><code>#define SYN_REPORT 0
#define SYN_CONFIG 1
/* SYN_MT_REPORT 与多点触控也有关系 不知道低版本是否兼容 */
#define SYN_MT_REPORT 2
</code></pre></div></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/francecil/blog/edit/master/docs/04.客户端/Android/应用开发/Android模拟触控解决方案.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=%E5%A4%9A%E7%82%B9%E8%A7%A6%E6%8E%A7" title="标签">#多点触控</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/07/05, 08:57:31</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/b34eef/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Android开发技巧</div></a> <a href="/pages/347b8f/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Android监听屏幕旋转</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/b34eef/" class="prev">Android开发技巧</a></span> <span class="next"><a href="/pages/347b8f/">Android监听屏幕旋转</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/ba9917/"><div>
            浅谈 package-lock.json 合并冲突修复算法
            <!----></div></a> <span class="date">07-05</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/17b23b/"><div>
            开启 diff3，帮助解决 Git 合并冲突难题
            <!----></div></a> <span class="date">07-04</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/0aacae/"><div>
            前端依赖一致性的问题分析与最佳实践
            <!----></div></a> <span class="date">07-01</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:396324491@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/francecil" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2016-2023
    <span>Gahing | <a href="http://www.beian.gov.cn" target="__blank">闽ICP备19024221号-1</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.b016e1be.js" defer></script><script src="/assets/js/3.5735a215.js" defer></script><script src="/assets/js/341.c3172dd3.js" defer></script>
  </body>
</html>
