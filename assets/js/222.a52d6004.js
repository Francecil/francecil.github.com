(window.webpackJsonp=window.webpackJsonp||[]).push([[222],{975:function(t,s,e){"use strict";e.r(s);var a=e(27),n=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("ul",[s("li",[t._v("核心指标："),s("strong",[t._v("FCP、FMP、LCP、TTI")])]),t._v(" "),s("li",[t._v("指标计算：FMP 需要使用 "),s("code",[t._v("MutationObserver")]),t._v(" 模拟计算；TTI 需要使用 Performance API 协助计算；其他指标基本可以通过 Performance API 直接获取")]),t._v(" "),s("li",[t._v("注意事项：\n"),s("ul",[s("li",[t._v("预渲染模式下，由于存在网络和 CPU 抢占情况，性能数据会偏高，指标意义不大")]),t._v(" "),s("li",[t._v("Paint 部分指标存在兼容问题，此时选用 FMP 指标代替")])])]),t._v(" "),s("li",[t._v("使用方式："),s("a",{attrs:{href:"https://github.com/GoogleChrome/web-vitals",target:"_blank",rel:"noopener noreferrer"}},[t._v("web-vitals"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"fp-fcp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fp-fcp"}},[t._v("#")]),t._v(" FP/FCP")]),t._v(" "),s("ul",[s("li",[t._v("定义：首次渲染时间点/首次有内容（文本，图片，SVG，canvas）渲染的时间点\n"),s("blockquote",[s("p",[t._v("FP 可视为白屏时间")])])]),t._v(" "),s("li",[t._v("计算方式：通过 "),s("code",[t._v("performance.getEntriesByType('paint')")]),t._v(" 获取")]),t._v(" "),s("li",[t._v("建议指标：FCP(pct75) < 1.8s")]),t._v(" "),s("li",[t._v("注意事项：\n"),s("ul",[s("li",[t._v("safari 14.x 以下不支持，详见 "),s("a",{attrs:{href:"https://caniuse.com/mdn-api_performancepainttiming",target:"_blank",rel:"noopener noreferrer"}},[t._v("caniuse"),s("OutboundLink")],1)])])])]),t._v(" "),s("p",[t._v("更多详见 "),s("a",{attrs:{href:"https://web.dev/fcp/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://web.dev/fcp/"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"fmp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fmp"}},[t._v("#")]),t._v(" FMP")]),t._v(" "),s("ul",[s("li",[t._v("定义：首次绘制有意义内容的时间点\n"),s("blockquote",[s("p",[t._v("FMP 一般视为首屏时间")])])]),t._v(" "),s("li",[t._v("计算原则：页面结构趋于稳定。")]),t._v(" "),s("li",[t._v("计算方式：MutationObserver 监听页面结构变化，得到一个分数，分数变化最剧烈的时间点，则为 FMP 。该技术值比真实值略小，误差小于 300ms")]),t._v(" "),s("li",[t._v("建议指标：FMP(pct75) < 2s")]),t._v(" "),s("li",[t._v("注意事项：\n"),s("ul",[s("li",[t._v("非标准化指标，Lighthouse 已弃用并推荐 LCP 代替；但由于 LCP Safari 兼容性的原因，目前 FMP 在移动端上还是有一定的参考价值。")])])])]),t._v(" "),s("p",[t._v("更多详见 "),s("a",{attrs:{href:"https://developer.chrome.com/en/docs/lighthouse/performance/first-meaningful-paint/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://developer.chrome.com/en/docs/lighthouse/performance/first-meaningful-paint/"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"lcp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lcp"}},[t._v("#")]),t._v(" LCP")]),t._v(" "),s("ul",[s("li",[t._v("定义：页面可视区域内可见的最大图像或文本块完成渲染的时间点")]),t._v(" "),s("li",[t._v("计算方式：通过 PerformanceObserver 监听 LCP 指标，该指标可能会拿到多次，一般仅用第一次数据")]),t._v(" "),s("li",[t._v("建议指标：LCP(pct75) < 2.5s ；活动类业务建议在 1.5s 内")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PerformanceObserver")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("entryList")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" entry "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" entryList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntries")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'LCP candidate:'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("startTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" entry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'largest-contentful-paint'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("buffered")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("ul",[s("li",[t._v("注意事项：\n"),s("ul",[s("li",[t._v("safari 不支持：见 "),s("a",{attrs:{href:"https://caniuse.com/mdn-api_largestcontentfulpaint",target:"_blank",rel:"noopener noreferrer"}},[t._v("caniuse"),s("OutboundLink")],1)])])])]),t._v(" "),s("p",[t._v("更多详见 "),s("a",{attrs:{href:"https://web.dev/lcp/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://web.dev/lcp/"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"tti"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tti"}},[t._v("#")]),t._v(" TTI")]),t._v(" "),s("ul",[s("li",[t._v("定义：页面完全可交互的时间点\n"),s("blockquote",[s("p",[t._v("完全可交互定义：1️⃣ 已显示有用内容；2️⃣ 可见元素已绑定事件；3️⃣ 事件函数可以在事件发生后的 50ms 内执行")])])]),t._v(" "),s("li",[t._v("计算原则：安静窗口前最后一个长任务的结束时间。安静窗口指的是没有长任务（执行时间超过 50 毫秒）且进行中的 GET 请求不超过 2 个")]),t._v(" "),s("li",[t._v("计算方式：从 FCP 开始向后搜寻一个不小于 5s 的安静窗口；找到后再向前搜索最近的长任务，取长任务的结束时间为 TTI")]),t._v(" "),s("li",[t._v("建议指标：TTI(pct75) < 5s ；活动类业务建议在 3s 内")]),t._v(" "),s("li",[t._v("注意事项：\n"),s("ul",[s("li",[t._v("使用 SSR 这类计算，追求首屏渲染会导致 TTI 降低，实践中应该关注两者的差值，不宜过大（超过 4s）")]),t._v(" "),s("li",[t._v("计算指标时可能会找不到长任务，此时则以 "),s("code",[t._v("max(FCP,DOMContentLoadedEventEnd)")]),t._v(" 作为 TTI 的值")]),t._v(" "),s("li",[t._v("兼容性上依赖于  Long Tasks API 和 Resource Timing API （均为 Performance 接口）")])])])]),t._v(" "),s("p",[t._v("更多详见 "),s("a",{attrs:{href:"https://web.dev/tti/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://web.dev/tti/"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"拓展阅读"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#拓展阅读"}},[t._v("#")]),t._v(" 拓展阅读")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.volcengine.com/docs/6431/107445",target:"_blank",rel:"noopener noreferrer"}},[t._v("字节性能指标计算"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=n.exports}}]);